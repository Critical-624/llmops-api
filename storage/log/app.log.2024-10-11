[2024-10-11 00:24:27,246.246] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 00:24:27,247.247] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 00:24:27,250.250] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:24:36,901.901] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:24:36,903.903] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:24:47,621.621] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 00:24:47,622.622] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 00:24:47,650.650] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 00:24:47,651.651] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 00:24:47,652.652] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 00:24:47,652.652] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 00:24:47,653.653] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:24:47,656.656] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 00:24:47,656.656] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2024-10-11 00:24:47,771.771] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2024-10-11 00:24:47,771.771] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2024-10-11 00:24:47,825.825] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:47,826.826] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00039s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:47,960.960] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:47,960.960] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:47,988.988] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:47,988.988] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'coalesce_2': 0, 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:48,010.010] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:24:48,011.011] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:24:48] "GET /datasets HTTP/1.1" 200 -
[2024-10-11 00:24:48,085.085] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:24:48,098.098] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:24:48] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:24:54,413.413] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:24:54,413.413] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 00:24:54,414.414] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:54,415.415] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:54,415.415] base.py -> _exec_single_context line:1908 [INFO]: [cached since 6.59s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:54,417.417] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:54,417.417] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00018s] {'coalesce_2': 0, 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:54,498.498] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:54,498.498] base.py -> _exec_single_context line:1908 [INFO]: [cached since 6.539s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:54,499.499] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 00:24:54,499.499] base.py -> _exec_single_context line:1908 [INFO]: [cached since 6.511s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:24:54,500.500] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:24:54,500.500] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:24:54] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89 HTTP/1.1" 200 -
[2024-10-11 00:24:54,665.665] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:24:54,690.690] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:24:54] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:25:01,522.522] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:25:01,522.522] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 00:25:01,522.522] base.py -> _exec_single_context line:1908 [INFO]: [cached since 7.109s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:25:01,527.527] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 00:25:01,527.527] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 00:25:01,542.542] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 00:25:01,542.542] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00018s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 00:25:01,544.544] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 00:25:01,544.544] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'coalesce_2': 0, 'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:01,545.545] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 00:25:01,545.545] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.0009422s ago] {'coalesce_2': 0, 'document_id_1': UUID('fc0e0fd4-a0a8-4ce6-820f-d40692678f0e')}
[2024-10-11 00:25:01,545.545] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:25:01,546.546] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:01] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 00:25:01,882.882] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:25:01,906.906] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:01] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:25:10,533.533] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:25:10,534.534] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 00:25:10,534.534] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:10,536.536] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 00:25:10,536.536] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:10,551.551] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 00:25:10,551.551] base.py -> _exec_single_context line:1908 [INFO]: [cached since 9.008s ago] {'coalesce_2': 0, 'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:10,552.552] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:25:10,552.552] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:10] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e HTTP/1.1" 200 -
[2024-10-11 00:25:10,880.880] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:25:10,890.890] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:10] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:25:14,792.792] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:25:14,793.793] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 00:25:14,793.793] base.py -> _exec_single_context line:1908 [INFO]: [cached since 4.259s ago] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:14,794.794] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 'GetSegmentsWithPageReq' object has no attribute 'current_page'
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 37, in get_segments_with_page
    segments, paginator = self.segment_service.get_segments_with_page(dataset_id, document_id, req)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 41, in get_segments_with_page
    paginator = Paginator(db=self.db, req=req)
  File "D:\Code\llmops\llmops-api\pkg\paginator\paginator.py", line 41, in __init__
    self.current_page = req.current_page.data
AttributeError: 'GetSegmentsWithPageReq' object has no attribute 'current_page'
[2024-10-11 00:25:14,798.798] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:25:14,807.807] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:14] "[35m[1mGET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments HTTP/1.1[0m" 500 -
[2024-10-11 00:25:15,222.222] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:15] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
[2024-10-11 00:25:15,227.227] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:15] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
[2024-10-11 00:25:15,377.377] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:15] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
[2024-10-11 00:25:15,545.545] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:15] "[36mGET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 304 -
[2024-10-11 00:25:33,539.539] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 00:25:33,861.861] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:25:40,521.521] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:25:40,524.524] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:25:40,677.677] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 00:25:40,677.677] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 00:25:40,678.678] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 00:25:40,678.678] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 00:25:40,679.679] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 00:25:40,679.679] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 00:25:40,679.679] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:25:40,681.681] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 00:25:40,681.681] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:40,684.684] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 00:25:40,685.685] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e'), 'param_1': 20, 'param_2': 0}
[2024-10-11 00:25:40,703.703] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 00:25:40,703.703] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00018s] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:40,705.705] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:25:40,706.706] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:40] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments HTTP/1.1" 200 -
[2024-10-11 00:25:40,797.797] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:25:40,811.811] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:40] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:25:55,553.553] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:25:55,554.554] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 00:25:55,554.554] base.py -> _exec_single_context line:1908 [INFO]: [cached since 14.87s ago] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:55,556.556] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 00:25:55,557.557] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e'), 'content_1': '%æ…•è¯¾%', 'param_1': 20, 'param_2': 0}
[2024-10-11 00:25:55,562.562] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 00:25:55,562.562] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e'), 'content_1': '%æ…•è¯¾%'}
[2024-10-11 00:25:55,564.564] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:25:55,564.564] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:55] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments?search_word=æ…•è¯¾ HTTP/1.1" 200 -
[2024-10-11 00:25:55,804.804] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:25:55,826.826] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:55] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:25:58,499.499] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:25:58,500.500] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 00:25:58,500.500] base.py -> _exec_single_context line:1908 [INFO]: [cached since 17.82s ago] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:25:58,502.502] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 00:25:58,502.502] base.py -> _exec_single_context line:1908 [INFO]: [cached since 2.945s ago] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 00:25:58,504.504] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 00:25:58,504.504] base.py -> _exec_single_context line:1908 [INFO]: [cached since 2.942s ago] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e'), 'content_1': '%llm%'}
[2024-10-11 00:25:58,506.506] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:25:58,506.506] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:58] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments?search_word=llm HTTP/1.1" 200 -
[2024-10-11 00:25:58,838.838] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:25:58,862.862] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:25:58] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:26:03,914.914] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 00:26:03,914.914] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 00:26:03,914.914] base.py -> _exec_single_context line:1908 [INFO]: [cached since 23.23s ago] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:26:03,916.916] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 00:26:03,917.917] base.py -> _exec_single_context line:1908 [INFO]: [cached since 23.23s ago] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e'), 'param_1': 20, 'param_2': 0}
[2024-10-11 00:26:03,919.919] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 00:26:03,919.919] base.py -> _exec_single_context line:1908 [INFO]: [cached since 23.22s ago] {'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 00:26:03,922.922] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 00:26:03,924.924] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:26:03] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/segments HTTP/1.1" 200 -
[2024-10-11 00:26:04,278.278] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 00:26:04,300.300] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 00:26:04] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2024-10-11 00:27:03,958.958] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 00:27:04,255.255] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:27:10,822.822] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:27:10,825.825] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:27:16,795.795] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 00:27:17,089.089] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:27:23,785.785] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:27:23,787.787] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:27:35,472.472] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 00:27:35,720.720] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:27:42,399.399] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:27:42,401.401] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:27:50,676.676] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 00:27:50,950.950] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:27:57,784.784] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:27:57,787.787] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:28:17,563.563] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 00:28:17,835.835] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:28:24,565.565] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:28:24,567.567] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:28:39,984.984] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 00:28:40,243.243] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:29:00,000.000] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:29:06,738.738] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:29:06,741.741] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:30:06,741.741] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 00:30:06,995.995] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:30:13,656.656] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:30:13,659.659] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:30:25,293.293] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 00:30:25,569.569] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:30:32,279.279] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:30:32,282.282] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 00:31:00,087.087] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 00:31:00,336.336] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 00:31:06,912.912] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 00:31:06,914.914] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 09:11:48,760.760] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 09:11:48,761.761] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 09:11:48,762.762] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 09:11:52,352.352] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 09:11:52,354.354] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:00:26,126.126] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:00:26,415.415] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:00:29,778.778] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:00:29,781.781] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:00:33,442.442] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:00:33,797.797] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:00:37,171.171] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:00:37,176.176] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:01:19,864.864] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:01:20,161.161] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:01:23,857.857] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:01:23,860.860] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:01:30,943.943] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:01:31,199.199] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:01:34,501.501] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:01:34,503.503] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:01:54,195.195] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:01:54,512.512] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:01:57,831.831] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:01:57,834.834] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:02:02,689.689] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:02:02,958.958] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:02:06,159.159] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:02:06,162.162] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:03:12,878.878] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:03:13,159.159] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:03:16,742.742] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:03:16,745.745] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:03:26,141.141] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:03:26,398.398] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:03:29,530.530] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:03:29,532.532] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:04:57,929.929] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 10:04:58,218.218] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:05:01,719.719] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:05:01,721.721] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:05:11,117.117] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 10:05:11,381.381] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:05:15,043.043] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:05:15,046.046] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:05:52,057.057] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 10:05:52,057.057] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:05:52,060.060] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 10:05:52,060.060] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:05:52,061.061] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 10:05:52,061.061] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:05:52,062.062] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:05:52,064.064] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:05:52,064.064] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:05:52,177.177] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:05:52,177.177] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00032s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:05:52,371.371] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:05:52,371.371] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:05:52,439.439] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:05:52,439.439] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'coalesce_2': 0, 'document_id_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 10:05:52,559.559] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:05:52,560.560] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.1206s ago] {'coalesce_2': 0, 'document_id_1': UUID('fc0e0fd4-a0a8-4ce6-820f-d40692678f0e')}
[2024-10-11 10:05:52,561.561] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:05:52,562.562] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:05:52] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:06:07,057.057] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:06:07,058.058] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:06:07,058.058] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'pk_1': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 10:06:07,061.061] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:06:07,061.061] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'id': UUID('5af3a5aa-0bea-4202-8df5-f63767295f8e')}
[2024-10-11 10:06:07,062.062] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:06:07,149.149] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:06:07] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/5af3a5aa-0bea-4202-8df5-f63767295f8e/delete HTTP/1.1" 200 -
[2024-10-11 10:06:31,721.721] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:06:31,722.722] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:06:31,722.722] base.py -> _exec_single_context line:1908 [INFO]: [cached since 39.66s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:06:31,724.724] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:06:31,724.724] base.py -> _exec_single_context line:1908 [INFO]: [cached since 39.55s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:06:31,725.725] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:06:31,725.725] base.py -> _exec_single_context line:1908 [INFO]: [cached since 39.35s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:06:31,726.726] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:06:31,727.727] base.py -> _exec_single_context line:1908 [INFO]: [cached since 39.29s ago] {'coalesce_2': 0, 'document_id_1': UUID('fc0e0fd4-a0a8-4ce6-820f-d40692678f0e')}
[2024-10-11 10:06:31,727.727] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:06:31,728.728] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:06:31] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:06:37,002.002] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:06:37,003.003] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:06:37,003.003] base.py -> _exec_single_context line:1908 [INFO]: [cached since 29.94s ago] {'pk_1': UUID('fc0e0fd4-a0a8-4ce6-820f-d40692678f0e')}
[2024-10-11 10:06:37,004.004] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:06:37,004.004] base.py -> _exec_single_context line:1908 [INFO]: [cached since 29.94s ago] {'id': UUID('fc0e0fd4-a0a8-4ce6-820f-d40692678f0e')}
[2024-10-11 10:06:37,005.005] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:06:37,040.040] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:06:37] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/fc0e0fd4-a0a8-4ce6-820f-d40692678f0e/delete HTTP/1.1" 200 -
[2024-10-11 10:06:41,679.679] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:06:41,679.679] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:06:41,679.679] base.py -> _exec_single_context line:1908 [INFO]: [cached since 49.62s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:06:41,682.682] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:06:41,682.682] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:06:41,767.767] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:06:41,768.768] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00031s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:06:41,894.894] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:06:41,920.920] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:06:41,921.921] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:06:41,921.921] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:06:41,923.923] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:06:41,923.923] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:06:41,925.925] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:06:41,926.926] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'pk_1': UUID('3f4dc6b1-db15-4e56-b44a-1244e7a090bd')}
[2024-10-11 10:06:42,022.022] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:06:42,022.022] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00031s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('3f4dc6b1-db15-4e56-b44a-1244e7a090bd'), 'batch': '20241011100641335862', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:06:42,043.043] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:06:42,078.078] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:06:42,079.079] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:06:42,079.079] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'pk_1': UUID('fd647715-4032-43d8-968f-f26e83300e0e')}
[2024-10-11 10:06:42,127.127] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:06:42,127.127] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:06:42] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:07:05,631.631] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:05,632.632] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:07:05,632.632] base.py -> _exec_single_context line:1908 [INFO]: [cached since 58.57s ago] {'pk_1': UUID('fd647715-4032-43d8-968f-f26e83300e0e')}
[2024-10-11 10:07:05,633.633] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:07:05,633.633] base.py -> _exec_single_context line:1908 [INFO]: [cached since 58.57s ago] {'id': UUID('fd647715-4032-43d8-968f-f26e83300e0e')}
[2024-10-11 10:07:05,634.634] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:05,672.672] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:05] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/fd647715-4032-43d8-968f-f26e83300e0e/delete HTTP/1.1" 200 -
[2024-10-11 10:07:11,525.525] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:11,525.525] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:07:11,525.525] base.py -> _exec_single_context line:1908 [INFO]: [cached since 79.46s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:11,527.527] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:07:11,527.527] base.py -> _exec_single_context line:1908 [INFO]: [cached since 79.35s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:07:11,529.529] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:07:11,529.529] base.py -> _exec_single_context line:1908 [INFO]: [cached since 79.16s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:11,530.530] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:07:11,530.530] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:11] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:07:14,219.219] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:14,220.220] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,220.220] base.py -> _exec_single_context line:1908 [INFO]: [cached since 82.16s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:14,221.221] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:07:14,221.221] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.54s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:07:14,222.222] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:07:14,222.222] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.45s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:07:14,223.223] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:14,225.225] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:14,225.225] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:07:14,225.225] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.3s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:07:14,226.226] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,226.226] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.3s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:07:14,227.227] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,227.227] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.3s ago] {'pk_1': UUID('692d45c6-d795-4164-9785-ef47db72536a')}
[2024-10-11 10:07:14,228.228] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:07:14,228.228] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.21s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('692d45c6-d795-4164-9785-ef47db72536a'), 'batch': '20241011100714524049', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:07:14,229.229] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:14,230.230] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:14,230.230] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,230.230] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.15s ago] {'pk_1': UUID('f1728c48-f07f-4aa3-b56a-cd545f36e2d0')}
[2024-10-11 10:07:14,248.248] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:07:14,248.248] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:14] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:07:14,959.959] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:14,959.959] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,959.959] base.py -> _exec_single_context line:1908 [INFO]: [cached since 82.9s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:14,960.960] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:07:14,960.960] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.28s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:07:14,962.962] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:07:14,962.962] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.19s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:07:14,962.962] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:14,964.964] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:14,965.965] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:07:14,965.965] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.04s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:07:14,966.966] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,966.966] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.04s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:07:14,966.966] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,966.966] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.04s ago] {'pk_1': UUID('76d1093c-5710-4b1f-8f30-b17fa4a58c18')}
[2024-10-11 10:07:14,967.967] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:07:14,967.967] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.95s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('76d1093c-5710-4b1f-8f30-b17fa4a58c18'), 'batch': '20241011100714771267', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 2, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:07:14,967.967] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:14,969.969] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:14,969.969] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:07:14,969.969] base.py -> _exec_single_context line:1908 [INFO]: [cached since 32.89s ago] {'pk_1': UUID('bed972c0-9187-42da-98a8-5976f1fa2cb0')}
[2024-10-11 10:07:14,998.998] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:07:14,999.999] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:14] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:07:27,852.852] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:27,852.852] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:07:27,852.852] base.py -> _exec_single_context line:1908 [INFO]: [cached since 80.79s ago] {'pk_1': UUID('bed972c0-9187-42da-98a8-5976f1fa2cb0')}
[2024-10-11 10:07:27,853.853] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:07:27,853.853] base.py -> _exec_single_context line:1908 [INFO]: [cached since 80.79s ago] {'id': UUID('bed972c0-9187-42da-98a8-5976f1fa2cb0')}
[2024-10-11 10:07:27,854.854] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:27,881.881] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:27] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/bed972c0-9187-42da-98a8-5976f1fa2cb0/delete HTTP/1.1" 200 -
[2024-10-11 10:07:32,368.368] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:32,368.368] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:07:32,368.368] base.py -> _exec_single_context line:1908 [INFO]: [cached since 100.3s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:32,370.370] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:07:32,370.370] base.py -> _exec_single_context line:1908 [INFO]: [cached since 100.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:07:32,372.372] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:07:32,372.372] base.py -> _exec_single_context line:1908 [INFO]: [cached since 100s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:32,373.373] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:07:32,373.373] base.py -> _exec_single_context line:1908 [INFO]: [cached since 99.93s ago] {'coalesce_2': 0, 'document_id_1': UUID('f1728c48-f07f-4aa3-b56a-cd545f36e2d0')}
[2024-10-11 10:07:32,375.375] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:07:32,375.375] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:32] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:07:37,979.979] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:37,979.979] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:07:37,979.979] base.py -> _exec_single_context line:1908 [INFO]: [cached since 90.92s ago] {'pk_1': UUID('f1728c48-f07f-4aa3-b56a-cd545f36e2d0')}
[2024-10-11 10:07:37,980.980] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:07:37,980.980] base.py -> _exec_single_context line:1908 [INFO]: [cached since 90.92s ago] {'id': UUID('f1728c48-f07f-4aa3-b56a-cd545f36e2d0')}
[2024-10-11 10:07:37,981.981] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:07:38,002.002] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:38] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/f1728c48-f07f-4aa3-b56a-cd545f36e2d0/delete HTTP/1.1" 200 -
[2024-10-11 10:07:55,486.486] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:07:55,486.486] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:07:55,487.487] base.py -> _exec_single_context line:1908 [INFO]: [cached since 123.4s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:55,488.488] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:07:55,488.488] base.py -> _exec_single_context line:1908 [INFO]: [cached since 123.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:07:55,489.489] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:07:55,489.489] base.py -> _exec_single_context line:1908 [INFO]: [cached since 123.1s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:07:55,490.490] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:07:55,490.490] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:07:55] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:08:00,009.009] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:00,009.009] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:08:00,009.009] base.py -> _exec_single_context line:1908 [INFO]: [cached since 127.9s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:08:00,011.011] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:08:00,011.011] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78.33s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:08:00,012.012] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:08:00,012.012] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78.24s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:08:00,012.012] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:08:00,015.015] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:00,015.015] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:08:00,015.015] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78.09s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:08:00,016.016] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:08:00,016.016] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78.09s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:08:00,017.017] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:08:00,017.017] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78.09s ago] {'pk_1': UUID('d75aeb95-149f-447a-bf26-e91149a072f6')}
[2024-10-11 10:08:00,017.017] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:08:00,017.017] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('d75aeb95-149f-447a-bf26-e91149a072f6'), 'batch': '20241011100800468059', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:08:00,018.018] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:08:00,019.019] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:00,019.019] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:08:00,019.019] base.py -> _exec_single_context line:1908 [INFO]: [cached since 77.94s ago] {'pk_1': UUID('17cd3754-25e5-4403-a21d-941b5bb83e11')}
[2024-10-11 10:08:00,036.036] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:08:00,037.037] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:08:00] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:08:18,355.355] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:18,355.355] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:08:18,355.355] base.py -> _exec_single_context line:1908 [INFO]: [cached since 146.3s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:08:18,356.356] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:08:18,356.356] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.67s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:08:18,357.357] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:08:18,357.357] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.59s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:08:18,358.358] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:08:18,360.360] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:18,360.360] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:08:18,360.360] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.44s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:08:18,361.361] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:08:18,361.361] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.44s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:08:18,362.362] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:08:18,362.362] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.44s ago] {'pk_1': UUID('c07da808-83f2-42ec-bb69-38ac039a3b38')}
[2024-10-11 10:08:18,362.362] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:08:18,362.362] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.34s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('c07da808-83f2-42ec-bb69-38ac039a3b38'), 'batch': '20241011100818451103', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 2, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:08:18,363.363] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:08:18,364.364] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:18,364.364] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:08:18,364.364] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.29s ago] {'pk_1': UUID('f161d15a-82f8-4229-bd67-fefc9459acd2')}
[2024-10-11 10:08:18,381.381] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:08:18,381.381] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:08:18] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:08:23,214.214] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:23,214.214] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:08:23,214.214] base.py -> _exec_single_context line:1908 [INFO]: [cached since 151.2s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:08:23,216.216] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:08:23,216.216] base.py -> _exec_single_context line:1908 [INFO]: [cached since 151s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:08:23,217.217] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:08:23,217.217] base.py -> _exec_single_context line:1908 [INFO]: [cached since 150.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:08:23,218.218] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:08:23,218.218] base.py -> _exec_single_context line:1908 [INFO]: [cached since 150.8s ago] {'coalesce_2': 0, 'document_id_1': UUID('f161d15a-82f8-4229-bd67-fefc9459acd2')}
[2024-10-11 10:08:23,219.219] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:08:23,219.219] base.py -> _exec_single_context line:1908 [INFO]: [cached since 150.8s ago] {'coalesce_2': 0, 'document_id_1': UUID('17cd3754-25e5-4403-a21d-941b5bb83e11')}
[2024-10-11 10:08:23,220.220] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:08:23,221.221] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:08:23] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:08:36,423.423] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:08:36,423.423] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:08:36,424.424] base.py -> _exec_single_context line:1908 [INFO]: [cached since 149.4s ago] {'pk_1': UUID('f161d15a-82f8-4229-bd67-fefc9459acd2')}
[2024-10-11 10:08:36,425.425] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:08:36,425.425] base.py -> _exec_single_context line:1908 [INFO]: [cached since 149.4s ago] {'id': UUID('f161d15a-82f8-4229-bd67-fefc9459acd2')}
[2024-10-11 10:08:36,425.425] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:08:36,472.472] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:08:36] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/f161d15a-82f8-4229-bd67-fefc9459acd2/delete HTTP/1.1" 200 -
[2024-10-11 10:09:08,024.024] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:09:08,024.024] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:09:08,024.024] base.py -> _exec_single_context line:1908 [INFO]: [cached since 181s ago] {'pk_1': UUID('17cd3754-25e5-4403-a21d-941b5bb83e11')}
[2024-10-11 10:09:08,025.025] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 10:09:08,025.025] base.py -> _exec_single_context line:1908 [INFO]: [cached since 181s ago] {'id': UUID('17cd3754-25e5-4403-a21d-941b5bb83e11')}
[2024-10-11 10:09:08,026.026] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:09:08,044.044] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:09:08] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/17cd3754-25e5-4403-a21d-941b5bb83e11/delete HTTP/1.1" 200 -
[2024-10-11 10:09:12,454.454] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:09:12,454.454] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:09:12,454.454] base.py -> _exec_single_context line:1908 [INFO]: [cached since 200.4s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:09:12,456.456] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:09:12,456.456] base.py -> _exec_single_context line:1908 [INFO]: [cached since 200.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:09:12,457.457] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:09:12,457.457] base.py -> _exec_single_context line:1908 [INFO]: [cached since 200.1s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:09:12,458.458] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:09:12,458.458] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:09:12] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:13:57,668.668] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:13:57,956.956] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:14:01,306.306] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:14:01,309.309] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:15:06,824.824] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:15:07,162.162] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:15:10,465.465] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:15:10,468.468] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:15:16,487.487] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:15:16,767.767] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:15:19,928.928] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:15:19,930.930] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:18:36,214.214] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 10:18:36,577.577] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:18:39,818.818] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:18:39,820.820] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:20:56,709.709] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 10:20:56,987.987] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:21:00,176.176] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:21:00,178.178] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:21:18,325.325] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 10:21:18,325.325] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:21:18,326.326] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 10:21:18,326.326] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:21:18,326.326] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 10:21:18,326.326] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:21:18,327.327] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:21:18,328.328] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:21:18,328.328] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:21:18,332.332] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:21:18,332.332] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:21:18,334.334] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:21:18,334.334] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:21:18,335.335] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:21:18,335.335] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:21:18] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:21:20,983.983] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:21:20,984.984] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:21:20,984.984] base.py -> _exec_single_context line:1908 [INFO]: [cached since 2.655s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:21:20,987.987] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:21:20,987.987] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:21:20,989.989] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:21:20,990.990] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:21:20,990.990] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:21:20,992.992] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:21:20,995.995] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:21:20,995.995] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:21:20,997.997] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:21:20,997.997] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:21:20,999.999] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:21:20,999.999] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('327f0334-e197-4aa7-aa0c-e527d3129172')}
[2024-10-11 10:21:21,001.001] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:21:21,001.001] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('327f0334-e197-4aa7-aa0c-e527d3129172'), 'batch': '20241011102120726090', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:21:21,002.002] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:21:21,024.024] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:21:21,025.025] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:21:21,025.025] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'pk_1': UUID('0794ce8f-3b6c-426c-972a-97b514263f5b')}
[2024-10-11 10:21:21,087.087] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:21:21,087.087] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:21:21] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:21:23,626.626] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:21:23,627.627] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:21:23,627.627] base.py -> _exec_single_context line:1908 [INFO]: [cached since 5.299s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:21:23,629.629] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:21:23,629.629] base.py -> _exec_single_context line:1908 [INFO]: [cached since 5.297s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:21:23,630.630] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:21:23,630.630] base.py -> _exec_single_context line:1908 [INFO]: [cached since 5.297s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:21:23,633.633] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 10:21:23,633.633] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'coalesce_2': 0, 'document_id_1': UUID('0794ce8f-3b6c-426c-972a-97b514263f5b')}
[2024-10-11 10:21:23,634.634] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:21:23,635.635] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:21:23] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:22:05,062.062] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:22:05,063.063] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:22:05,063.063] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('0794ce8f-3b6c-426c-972a-97b514263f5b')}
[2024-10-11 10:22:05,066.066] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 10:22:05,066.066] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 10, 22, 5, 65670), 'document_id': UUID('0794ce8f-3b6c-426c-972a-97b514263f5b')}
[2024-10-11 10:22:05,067.067] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:22:05,073.073] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:22:05,073.073] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:22:05,073.073] base.py -> _exec_single_context line:1908 [INFO]: [cached since 44.05s ago] {'pk_1': UUID('0794ce8f-3b6c-426c-972a-97b514263f5b')}
[2024-10-11 10:22:05,121.121] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:22:05,121.121] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:22:05] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/0794ce8f-3b6c-426c-972a-97b514263f5b/enabled HTTP/1.1" 200 -
[2024-10-11 10:25:23,424.424] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\keyword_table_service.py', reloading
[2024-10-11 10:25:23,770.770] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 10:25:27,529.529] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 10:25:27,531.531] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 10:25:45,918.918] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 10:25:45,918.918] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:25:45,919.919] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 10:25:45,919.919] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:25:45,920.920] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 10:25:45,920.920] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 10:25:45,921.921] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:25:45,923.923] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:25:45,923.923] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00018s] {'pk_1': UUID('17cd3754-25e5-4403-a21d-941b5bb83e11')}
[2024-10-11 10:25:45,924.924] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 83, in delete_document
    self.document_service.delete_document(dataset_id, document_id)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 233, in delete_document
    raise NotFoundException("è¯¥æ–‡æ¡£ä¸å­˜åœ¨ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2024-10-11 10:25:45,926.926] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:25:45,927.927] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:25:45] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/17cd3754-25e5-4403-a21d-941b5bb83e11/delete HTTP/1.1" 200 -
[2024-10-11 10:26:09,145.145] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:26:09,146.146] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:26:09,146.146] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:26:09,149.149] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:26:09,149.149] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00018s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:26:09,152.152] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:26:09,152.152] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:26:09,153.153] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:26:09,153.153] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:26:09] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:26:12,694.694] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:26:12,694.694] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:26:12,694.694] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3.548s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:26:12,696.696] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:26:12,696.696] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:26:12,699.699] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:26:12,699.699] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:26:12,699.699] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:26:12,702.702] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:26:12,703.703] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:26:12,703.703] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:26:12,704.704] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:26:12,704.704] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:26:12,706.706] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:26:12,706.706] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('664a714f-effb-4660-ac71-5b9ead30c233')}
[2024-10-11 10:26:12,707.707] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:26:12,707.707] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('664a714f-effb-4660-ac71-5b9ead30c233'), 'batch': '20241011102612290400', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:26:12,708.708] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:26:12,712.712] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:26:12,713.713] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:26:12,713.713] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('45fba9f6-5dab-4e6a-bf5b-bfee47341a51')}
[2024-10-11 10:26:12,745.745] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:26:12,745.745] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:26:12] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:26:55,473.473] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:26:55,474.474] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:26:55,474.474] base.py -> _exec_single_context line:1908 [INFO]: [cached since 69.55s ago] {'pk_1': UUID('45fba9f6-5dab-4e6a-bf5b-bfee47341a51')}
[2024-10-11 10:26:55,475.475] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 77, in update_document_enabled
    self.document_service.update_document_enabled(dataset_id, document_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 200, in update_document_enabled
    raise ForbiddenException("å½“å‰æ–‡æ¡£å¤„äºŽä¸å¯ä¿®æ”¹çŠ¶æ€ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.ForbiddenException
[2024-10-11 10:26:55,476.476] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:26:55,477.477] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:26:55] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/45fba9f6-5dab-4e6a-bf5b-bfee47341a51/enabled HTTP/1.1" 200 -
[2024-10-11 10:27:50,769.769] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:27:50,769.769] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:27:50,769.769] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.6s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:27:50,770.770] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:27:50,770.770] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.6s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:27:50,770.770] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:27:50,771.771] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.6s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:27:50,772.772] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:27:50,772.772] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:27:50] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:27:53,861.861] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:27:53,861.861] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:27:53,861.861] base.py -> _exec_single_context line:1908 [INFO]: [cached since 104.7s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:27:53,862.862] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:27:53,862.862] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:27:53,863.863] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:27:53,863.863] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:27:53,864.864] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:27:53,866.866] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:27:53,866.866] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:27:53,866.866] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:27:53,867.867] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:27:53,867.867] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:27:53,867.867] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:27:53,867.867] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'pk_1': UUID('c64e38da-d2d4-4e9f-874a-048793c48926')}
[2024-10-11 10:27:53,868.868] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:27:53,868.868] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('c64e38da-d2d4-4e9f-874a-048793c48926'), 'batch': '20241011102753605925', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:27:53,868.868] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:27:53,869.869] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:27:53,870.870] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:27:53,870.870] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.2s ago] {'pk_1': UUID('1381c34c-2776-4eab-92ec-3ce3173d805e')}
[2024-10-11 10:27:53,887.887] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:27:53,887.887] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:27:53] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 10:28:53,145.145] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:28:53,145.145] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:28:53,145.145] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:28:53,147.147] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 10:28:53,147.147] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 10:28:53,147.147] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 10:28:53,148.148] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:28:53,148.148] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:28:53,149.149] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:28:53] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 10:28:56,965.965] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:28:56,966.966] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 10:28:56,966.966] base.py -> _exec_single_context line:1908 [INFO]: [cached since 167.8s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 10:28:56,967.967] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 10:28:56,968.968] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 10:28:56,969.969] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 10:28:56,969.969] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 10:28:56,970.970] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:28:56,973.973] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:28:56,973.973] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 10:28:56,973.973] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 10:28:56,974.974] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 10:28:56,974.974] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 10:28:56,975.975] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 10:28:56,975.975] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'pk_1': UUID('4311c6f4-39bb-452e-a9ed-8570e6cd5550')}
[2024-10-11 10:28:56,976.976] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 10:28:56,977.977] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('4311c6f4-39bb-452e-a9ed-8570e6cd5550'), 'batch': '20241011102856832156', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 10:28:56,979.979] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 10:28:56,981.981] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 10:28:56,981.981] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 10:28:56,981.981] base.py -> _exec_single_context line:1908 [INFO]: [cached since 164.3s ago] {'pk_1': UUID('1b85fa23-1d6d-440d-89d7-4607ff690036')}
[2024-10-11 10:28:57,020.020] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 10:28:57,021.021] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 10:28:57] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 11:17:27,475.475] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:17:27,478.478] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:17:27,478.478] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3078s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:17:27,485.485] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:17:27,485.485] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3078s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:17:27,488.488] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:17:27,488.488] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3078s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:17:27,495.495] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 11:17:27,495.495] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'coalesce_2': 0, 'document_id_1': UUID('1b85fa23-1d6d-440d-89d7-4607ff690036')}
[2024-10-11 11:17:27,499.499] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:17:27,499.499] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:17:27] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:17:35,846.846] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:17:35,847.847] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:17:35,847.847] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3110s ago] {'pk_1': UUID('1b85fa23-1d6d-440d-89d7-4607ff690036')}
[2024-10-11 11:17:35,849.849] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 83, in delete_document
    self.document_service.delete_document(dataset_id, document_id)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 239, in delete_document
    raise FailException("å½“å‰æ–‡æ¡£å¤„äºŽä¸å¯åˆ é™¤çŠ¶æ€ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.FailException
[2024-10-11 11:17:35,853.853] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:17:35,854.854] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:17:35] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/1b85fa23-1d6d-440d-89d7-4607ff690036/delete HTTP/1.1" 200 -
[2024-10-11 11:18:47,712.712] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:18:47,712.712] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:18:47,712.712] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3159s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:18:47,714.714] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:18:47,714.714] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3159s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:18:47,715.715] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:18:47,715.715] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3159s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:18:47,715.715] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:18:47,716.716] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:18:47] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:18:56,851.851] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:18:56,851.851] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:18:56,851.851] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3168s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:18:56,852.852] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 11:18:56,852.852] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 11:18:56,854.854] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 11:18:56,854.854] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 11:18:56,854.854] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:18:56,876.876] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:18:56,876.876] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 11:18:56,876.876] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 11:18:56,877.877] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 11:18:56,877.877] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 11:18:56,878.878] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 11:18:56,878.878] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'pk_1': UUID('21ffb746-490f-4d95-9183-f482d3b80a6c')}
[2024-10-11 11:18:56,879.879] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 11:18:56,879.879] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('21ffb746-490f-4d95-9183-f482d3b80a6c'), 'batch': '20241011111856936224', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 11:18:56,882.882] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:18:56,900.900] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:18:56,900.900] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:18:56,900.900] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3164s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:18:56,921.921] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:18:56,922.922] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:18:56] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 11:19:04,812.812] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:04,812.812] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:19:04,812.812] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3199s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:04,813.813] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 77, in update_document_enabled
    self.document_service.update_document_enabled(dataset_id, document_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 200, in update_document_enabled
    raise ForbiddenException("å½“å‰æ–‡æ¡£å¤„äºŽä¸å¯ä¿®æ”¹çŠ¶æ€ï¼Œè¯·ç¨åŽé‡è¯•")
internal.exception.exception.ForbiddenException
[2024-10-11 11:19:04,814.814] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:19:04,814.814] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:19:04] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/d58dbd84-afee-4819-8a77-b1f2476ef140/enabled HTTP/1.1" 200 -
[2024-10-11 11:19:10,945.945] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:10,945.945] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:19:10,945.945] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3205s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:10,949.949] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:19:10,949.949] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 19, 10, 947409), 'document_id': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:10,950.950] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:19:10,953.953] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:10,953.953] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:19:10,953.953] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3178s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:10,973.973] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:19:10,974.974] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:19:10] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/d58dbd84-afee-4819-8a77-b1f2476ef140/enabled HTTP/1.1" 200 -
[2024-10-11 11:19:25,735.735] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:25,735.735] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:19:25,735.735] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3220s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:25,736.736] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:19:25,736.736] base.py -> _exec_single_context line:1908 [INFO]: [cached since 14.79s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:25,737.737] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:19:25,739.739] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:25,739.739] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:19:25,740.740] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3193s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:25,757.757] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:19:25,758.758] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:19:25] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/d58dbd84-afee-4819-8a77-b1f2476ef140/enabled HTTP/1.1" 200 -
[2024-10-11 11:19:39,499.499] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:39,499.499] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:19:39,499.499] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3234s ago] {'pk_1': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:39,501.501] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 11:19:39,501.501] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'id': UUID('d58dbd84-afee-4819-8a77-b1f2476ef140')}
[2024-10-11 11:19:39,502.502] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:19:39,542.542] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:19:39] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/d58dbd84-afee-4819-8a77-b1f2476ef140/delete HTTP/1.1" 200 -
[2024-10-11 11:19:58,635.635] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:19:58,635.635] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:19:58,635.635] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3229s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:19:58,637.637] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:19:58,637.637] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3229s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:19:58,638.638] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:19:58,638.638] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3229s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:19:58,639.639] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:19:58,640.640] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:19:58] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:20:02,560.560] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:20:02,560.560] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:20:02,560.560] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3233s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:20:02,562.562] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 11:20:02,562.562] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 11:20:02,563.563] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 11:20:02,563.563] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 11:20:02,564.564] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:20:02,575.575] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:20:02,576.576] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 11:20:02,576.576] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 11:20:02,577.577] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 11:20:02,577.577] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 11:20:02,578.578] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 11:20:02,578.578] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'pk_1': UUID('d01e32ae-b0da-4dd5-95d7-571a5b294d7e')}
[2024-10-11 11:20:02,579.579] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 11:20:02,579.579] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('d01e32ae-b0da-4dd5-95d7-571a5b294d7e'), 'batch': '20241011112002208553', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 11:20:02,580.580] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:20:02,582.582] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:20:02,582.582] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:20:02,582.582] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3230s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:20:02,624.624] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:20:02,624.624] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:20:02] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 11:21:37,516.516] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:21:37,517.517] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:21:37,517.517] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3352s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:21:37,519.519] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:21:37,519.519] base.py -> _exec_single_context line:1908 [INFO]: [cached since 146.6s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 21, 37, 518240), 'document_id': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:21:37,519.519] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:21:37,560.560] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:21:37,560.560] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:21:37,560.560] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3325s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:21:37,598.598] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:21:37,598.598] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:21:37] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/4123c224-7766-45f1-af19-1e4a3b7e43b2/enabled HTTP/1.1" 200 -
[2024-10-11 11:22:07,919.919] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:07,919.919] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:07,919.919] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3382s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:07,921.921] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:22:07,921.921] base.py -> _exec_single_context line:1908 [INFO]: [cached since 177s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 22, 7, 920154), 'document_id': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:07,922.922] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:22:07,940.940] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:07,940.940] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:07,940.940] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3355s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:07,972.972] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:22:07,972.972] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:22:07] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/4123c224-7766-45f1-af19-1e4a3b7e43b2/enabled HTTP/1.1" 200 -
[2024-10-11 11:22:25,726.726] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:25,726.726] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:25,727.727] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3400s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:25,727.727] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:22:25,727.727] base.py -> _exec_single_context line:1908 [INFO]: [cached since 194.8s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 22, 25, 727973), 'document_id': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:25,728.728] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:22:25,730.730] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:25,731.731] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:25,731.731] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3373s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:25,748.748] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:22:25,748.748] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:22:25] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/4123c224-7766-45f1-af19-1e4a3b7e43b2/enabled HTTP/1.1" 200 -
[2024-10-11 11:22:29,756.756] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:29,756.756] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:29,756.756] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3404s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:29,757.757] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:22:29,757.757] base.py -> _exec_single_context line:1908 [INFO]: [cached since 198.8s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 22, 29, 757970), 'document_id': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:29,758.758] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:22:29,760.760] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:29,760.760] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:29,760.760] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3377s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:29,792.792] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:22:29,792.792] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:22:29] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/4123c224-7766-45f1-af19-1e4a3b7e43b2/enabled HTTP/1.1" 200 -
[2024-10-11 11:22:30,427.427] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:30,427.427] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:30,427.427] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3405s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:30,428.428] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 77, in update_document_enabled
    self.document_service.update_document_enabled(dataset_id, document_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 204, in update_document_enabled
    raise FailException(f"æ–‡æ¡£çŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}çŠ¶æ€")
internal.exception.exception.FailException
[2024-10-11 11:22:30,429.429] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:22:30,429.429] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:22:30] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/4123c224-7766-45f1-af19-1e4a3b7e43b2/enabled HTTP/1.1" 200 -
[2024-10-11 11:22:37,582.582] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:22:37,582.582] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:22:37,582.582] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3412s ago] {'pk_1': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:37,582.582] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 11:22:37,582.582] base.py -> _exec_single_context line:1908 [INFO]: [cached since 178.1s ago] {'id': UUID('4123c224-7766-45f1-af19-1e4a3b7e43b2')}
[2024-10-11 11:22:37,582.582] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:22:37,602.602] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:22:37] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/4123c224-7766-45f1-af19-1e4a3b7e43b2/delete HTTP/1.1" 200 -
[2024-10-11 11:23:09,746.746] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:23:09,746.746] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:23:09,746.746] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3421s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:23:09,748.748] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:23:09,748.748] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3421s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:23:09,749.749] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:23:09,749.749] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3421s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:23:09,750.750] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:23:09,751.751] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:23:09] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:23:16,360.360] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:23:16,360.360] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:23:16,360.360] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3427s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:23:16,362.362] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 11:23:16,362.362] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 11:23:16,362.362] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 11:23:16,362.362] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 11:23:16,363.363] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:23:16,377.377] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:23:16,377.377] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 11:23:16,377.377] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 11:23:16,378.378] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 11:23:16,378.378] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 11:23:16,379.379] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 11:23:16,379.379] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'pk_1': UUID('53516546-0575-4e31-8acb-29e6325d484b')}
[2024-10-11 11:23:16,381.381] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 11:23:16,381.381] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('53516546-0575-4e31-8acb-29e6325d484b'), 'batch': '20241011112316866805', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 11:23:16,382.382] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:23:16,399.399] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:23:16,399.399] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:23:16,400.400] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3424s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:23:16,451.451] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:23:16,452.452] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:23:16] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 11:25:28,986.986] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:25:28,987.987] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:25:28,987.987] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3583s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:25:28,989.989] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:25:28,989.989] base.py -> _exec_single_context line:1908 [INFO]: [cached since 378s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 25, 28, 989051), 'document_id': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:25:28,990.990] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:25:28,993.993] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:25:28,993.993] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:25:28,993.993] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3556s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:25:29,042.042] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:25:29,042.042] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:25:29] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/787e051b-3c4d-4ec2-a8e1-8beea16e1bbe/enabled HTTP/1.1" 200 -
[2024-10-11 11:25:57,959.959] base.py -> get_connection line:842 [INFO]: Connection <connection object at 0x000001AAF0F0B450; dsn: 'user=postgres password=xxx dbname=llmops host=192.168.2.120 port=5432 client_encoding=utf8', closed: 0> exceeded timeout; recycling
[2024-10-11 11:25:57,976.976] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:25:57,977.977] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:25:57,977.977] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3612s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:25:57,978.978] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:25:57,979.979] base.py -> _exec_single_context line:1908 [INFO]: [cached since 407s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 25, 57, 978797), 'document_id': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:25:57,979.979] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:25:58,015.015] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:25:58,016.016] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:25:58,016.016] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3585s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:25:58,034.034] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:25:58,034.034] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:25:58] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/787e051b-3c4d-4ec2-a8e1-8beea16e1bbe/enabled HTTP/1.1" 200 -
[2024-10-11 11:26:57,091.091] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:26:57,091.091] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:26:57,091.091] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3671s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:26:57,093.093] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:26:57,093.093] base.py -> _exec_single_context line:1908 [INFO]: [cached since 466.1s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 26, 57, 93712), 'document_id': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:26:57,094.094] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:26:57,113.113] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:26:57,113.113] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:26:57,113.113] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3644s ago] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:26:57,130.130] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:26:57,130.130] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:26:57] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/787e051b-3c4d-4ec2-a8e1-8beea16e1bbe/enabled HTTP/1.1" 200 -
[2024-10-11 11:27:16,389.389] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 11:27:16,864.864] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 11:27:24,520.520] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 11:27:24,523.523] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 11:27:28,465.465] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 11:27:28,465.465] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:27:28,466.466] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 11:27:28,466.466] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:27:28,467.467] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 11:27:28,467.467] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:27:28,467.467] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:27:28,469.469] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:27:28,469.469] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:27:28,472.472] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:27:28,472.472] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 27, 28, 471382), 'document_id': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:27:28,473.473] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:27:28,479.479] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:27:28,480.480] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:27:28,480.480] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:27:28,513.513] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:27:28,513.513] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:27:28] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/787e051b-3c4d-4ec2-a8e1-8beea16e1bbe/enabled HTTP/1.1" 200 -
[2024-10-11 11:28:29,077.077] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 11:28:29,368.368] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 11:28:36,313.313] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 11:28:36,315.315] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 11:28:42,801.801] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 11:28:42,801.801] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:28:42,801.801] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 11:28:42,801.801] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:28:42,802.802] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 11:28:42,802.802] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:28:42,802.802] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:28:42,804.804] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:28:42,804.804] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:28:42,807.807] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:28:42,807.807] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 28, 42, 806224), 'document_id': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:28:42,808.808] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:28:42,813.813] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:28:42,814.814] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:28:42,814.814] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00012s] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:28:42,843.843] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:28:42,844.844] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:28:42] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/787e051b-3c4d-4ec2-a8e1-8beea16e1bbe/enabled HTTP/1.1" 200 -
[2024-10-11 11:29:58,209.209] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 11:29:58,493.493] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 11:30:05,511.511] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 11:30:05,514.514] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 11:30:56,825.825] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 11:30:56,826.826] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:30:56,827.827] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 11:30:56,827.827] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:30:56,827.827] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 11:30:56,827.827] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:30:56,828.828] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:30:56,829.829] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:30:56,830.830] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:30:56,831.831] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 11:30:56,831.831] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00011s] {'id': UUID('787e051b-3c4d-4ec2-a8e1-8beea16e1bbe')}
[2024-10-11 11:30:56,832.832] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:30:56,876.876] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:30:56] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/787e051b-3c4d-4ec2-a8e1-8beea16e1bbe/delete HTTP/1.1" 200 -
[2024-10-11 11:31:38,523.523] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:31:38,524.524] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:31:38,524.524] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:31:38,526.526] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 11:31:38,526.526] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 11:31:38,528.528] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 11:31:38,528.528] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 11:31:38,529.529] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:31:38,532.532] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:31:38,533.533] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 11:31:38,533.533] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 11:31:38,547.547] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 11:31:38,547.547] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 11:31:38,548.548] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 11:31:38,548.548] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('525493e2-eadb-4d42-afbd-b6023a4a65e8')}
[2024-10-11 11:31:38,549.549] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 11:31:38,550.550] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('525493e2-eadb-4d42-afbd-b6023a4a65e8'), 'batch': '20241011113138547075', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 11:31:38,550.550] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:31:38,552.552] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:31:38,552.552] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:31:38,552.552] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00011s] {'pk_1': UUID('2c18ff36-04a6-4e96-adcd-0e582c3d8f79')}
[2024-10-11 11:31:38,569.569] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:31:38,570.570] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:31:38] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 11:38:03,018.018] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 11:38:03,018.018] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 11:38:03,019.019] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 11:38:06,492.492] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 11:38:06,494.494] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 11:38:09,068.068] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 11:38:09,068.068] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:38:09,069.069] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 11:38:09,069.069] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:38:09,069.069] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 11:38:09,069.069] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:38:09,070.070] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:38:09,071.071] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:38:09,071.071] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:38:09,074.074] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:38:09,075.075] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:38:09,077.077] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:38:09,078.078] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00035s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:38:09,080.080] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 11:38:09,080.080] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'coalesce_2': 0, 'document_id_1': UUID('2c18ff36-04a6-4e96-adcd-0e582c3d8f79')}
[2024-10-11 11:38:09,081.081] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:38:09,081.081] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:38:09] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:38:16,093.093] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:38:16,094.094] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:38:16,094.094] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('2c18ff36-04a6-4e96-adcd-0e582c3d8f79')}
[2024-10-11 11:38:16,097.097] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 11:38:16,097.097] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'id': UUID('2c18ff36-04a6-4e96-adcd-0e582c3d8f79')}
[2024-10-11 11:38:16,098.098] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:38:16,176.176] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:38:16] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/2c18ff36-04a6-4e96-adcd-0e582c3d8f79/delete HTTP/1.1" 200 -
[2024-10-11 11:38:20,611.611] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:38:20,611.611] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:38:20,611.611] base.py -> _exec_single_context line:1908 [INFO]: [cached since 11.54s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:38:20,613.613] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:38:20,613.613] base.py -> _exec_single_context line:1908 [INFO]: [cached since 11.54s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:38:20,613.613] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:38:20,614.614] base.py -> _exec_single_context line:1908 [INFO]: [cached since 11.54s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:38:20,614.614] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:38:20,615.615] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:38:20] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:39:28,429.429] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:39:28,429.429] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:39:28,429.429] base.py -> _exec_single_context line:1908 [INFO]: [cached since 79.36s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:39:47,331.331] base.py -> invalidate line:799 [INFO]: Invalidate connection <connection object at 0x00000151ACC1B560; dsn: 'user=postgres password=xxx dbname=llmops host=192.168.8.180 port=5432 client_encoding=utf8', closed: 2> (reason: OperationalError:server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.
)
[2024-10-11 11:39:47,331.331] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: (psycopg2.OperationalError) server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[SQL: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID]
[parameters: {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.OperationalError: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 42, in create_documents
    documents, batch = self.document_service.create_documents(dataset_id, **req.data)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 51, in create_documents
    dataset = self.get(Dataset, dataset_id)
  File "D:\Code\llmops\llmops-api\internal\service\base_service.py", line 43, in get
    return self.db.session.query(model).get(primary_key)
  File "<string>", line 2, in get
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\query.py", line 1136, in _get_impl
    return self.session._get_impl(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\session.py", line 3817, in _get_impl
    return db_load_fn(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\loading.py", line 694, in load_on_pk_identity
    session.execute(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1422, in execute
    return meth(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1850, in _execute_context
    return self._exec_single_context(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\engine\default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[SQL: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID]
[parameters: {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
[2024-10-11 11:39:47,364.364] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:39:47] "[35m[1mPOST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1[0m" 500 -
[2024-10-11 11:44:39,393.393] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 11:44:39,393.393] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 11:44:39,394.394] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 11:44:43,009.009] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 11:44:43,011.011] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 11:44:53,251.251] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 11:44:53,251.251] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:44:53,252.252] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 11:44:53,252.252] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:44:53,252.252] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 11:44:53,253.253] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 11:44:53,253.253] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:44:53,254.254] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:44:53,254.254] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:44:53,309.309] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:44:53,309.309] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:44:53,364.364] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:44:53,364.364] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:44:53,366.366] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:44:53,366.366] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:44:53] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:44:55,735.735] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:44:55,736.736] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:44:55,736.736] base.py -> _exec_single_context line:1908 [INFO]: [cached since 2.482s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:44:55,740.740] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 11:44:55,740.740] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00036s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 11:44:55,761.761] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 11:44:55,761.761] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00031s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 11:44:56,111.111] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:44:56,171.171] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:44:56,172.172] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 11:44:56,172.172] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 11:44:56,174.174] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 11:44:56,175.175] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 11:44:56,177.177] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 11:44:56,177.177] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'pk_1': UUID('6929510f-0b2e-4cd5-b47f-094f2724ef01')}
[2024-10-11 11:44:56,285.285] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 11:44:56,285.285] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00032s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('6929510f-0b2e-4cd5-b47f-094f2724ef01'), 'batch': '20241011114455900424', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 11:44:56,310.310] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:44:56,318.318] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:44:56,319.319] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:44:56,319.319] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 11:44:56,380.380] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:44:56,381.381] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:44:56] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 11:45:01,784.784] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:45:01,785.785] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 11:45:01,785.785] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.53s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:45:01,786.786] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 11:45:01,787.787] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.477s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 11:45:01,787.787] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 11:45:01,787.787] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.423s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 11:45:01,790.790] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 11:45:01,790.790] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'coalesce_2': 0, 'document_id_1': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 11:45:01,791.791] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:45:01,792.792] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:45:01] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 11:47:08,415.415] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:47:08,416.416] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:47:08,416.416] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'pk_1': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 11:47:08,420.420] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 11:47:08,420.420] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 11, 47, 8, 419525), 'document_id': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 11:47:08,421.421] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 11:47:08,440.440] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 11:47:08,440.440] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 11:47:08,440.440] base.py -> _exec_single_context line:1908 [INFO]: [cached since 132.1s ago] {'pk_1': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 11:47:08,484.484] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 11:47:08,485.485] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 11:47:08] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/dfdae093-d52b-4385-a280-8592478bdf7f/enabled HTTP/1.1" 200 -
[2024-10-11 12:01:26,068.068] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:26,068.068] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:01:26,068.068] base.py -> _exec_single_context line:1908 [INFO]: [cached since 992.8s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:01:26,070.070] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 12:01:26,070.070] base.py -> _exec_single_context line:1908 [INFO]: [cached since 992.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 12:01:26,071.071] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 12:01:26,071.071] base.py -> _exec_single_context line:1908 [INFO]: [cached since 992.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:01:26,072.072] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 12:01:26,073.073] base.py -> _exec_single_context line:1908 [INFO]: [cached since 984.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 12:01:26,074.074] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:01:26,074.074] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:01:26] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 12:01:31,727.727] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:31,727.727] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:01:31,728.728] base.py -> _exec_single_context line:1908 [INFO]: [cached since 863.3s ago] {'pk_1': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 12:01:31,729.729] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 12:01:31,730.730] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'id': UUID('dfdae093-d52b-4385-a280-8592478bdf7f')}
[2024-10-11 12:01:31,730.730] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:01:31,772.772] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:01:31] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/dfdae093-d52b-4385-a280-8592478bdf7f/delete HTTP/1.1" 200 -
[2024-10-11 12:01:33,936.936] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:33,937.937] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:01:33,937.937] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1001s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:01:33,938.938] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 12:01:33,939.939] base.py -> _exec_single_context line:1908 [INFO]: [cached since 998.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 12:01:33,940.940] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 12:01:33,940.940] base.py -> _exec_single_context line:1908 [INFO]: [cached since 998.2s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 12:01:33,941.941] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:01:33,943.943] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:33,944.944] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 12:01:33,944.944] base.py -> _exec_single_context line:1908 [INFO]: [cached since 997.8s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 12:01:33,945.945] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 12:01:33,945.945] base.py -> _exec_single_context line:1908 [INFO]: [cached since 997.8s ago] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 12:01:33,947.947] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 12:01:33,947.947] base.py -> _exec_single_context line:1908 [INFO]: [cached since 997.8s ago] {'pk_1': UUID('6e82adc3-8df1-42ff-98bd-ffbfa25852cf')}
[2024-10-11 12:01:33,948.948] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 12:01:33,948.948] base.py -> _exec_single_context line:1908 [INFO]: [cached since 997.7s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('6e82adc3-8df1-42ff-98bd-ffbfa25852cf'), 'batch': '20241011120133638799', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 12:01:33,949.949] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:01:33,950.950] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:33,951.951] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:01:33,951.951] base.py -> _exec_single_context line:1908 [INFO]: [cached since 997.6s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:01:33,990.990] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:01:33,991.991] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:01:33] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 12:01:38,476.476] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:38,476.476] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:01:38,476.476] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1005s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:01:38,478.478] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 12:01:38,478.478] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1005s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 12:01:38,479.479] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 12:01:38,479.479] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1005s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:01:38,480.480] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 12:01:38,480.480] base.py -> _exec_single_context line:1908 [INFO]: [cached since 996.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:01:38,481.481] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:01:38,481.481] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:01:38] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 12:01:43,276.276] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:43,276.276] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:01:43,277.277] base.py -> _exec_single_context line:1908 [INFO]: [cached since 874.9s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:01:43,278.278] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 12:01:43,279.279] base.py -> _exec_single_context line:1908 [INFO]: [cached since 874.9s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 12, 1, 43, 278784), 'document_id': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:01:43,279.279] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:01:43,282.282] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:01:43,282.282] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:01:43,283.283] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1007s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:01:43,319.319] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:01:43,319.319] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:01:43] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8/enabled HTTP/1.1" 200 -
[2024-10-11 12:02:15,202.202] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:02:15,203.203] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:02:15,203.203] base.py -> _exec_single_context line:1908 [INFO]: [cached since 906.8s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:02:15,204.204] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 12:02:15,204.204] base.py -> _exec_single_context line:1908 [INFO]: [cached since 906.8s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:02:15,205.205] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:02:15,208.208] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:02:15,208.208] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:02:15,209.209] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1039s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:02:15,246.246] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:02:15,247.247] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:02:15] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8/enabled HTTP/1.1" 200 -
[2024-10-11 12:05:43,568.568] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:05:43,568.568] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:05:43,569.569] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1250s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:05:43,570.570] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 12:05:43,570.570] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1250s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 12:05:43,571.571] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 12:05:43,572.572] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1250s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:05:43,573.573] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 12:05:43,573.573] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1242s ago] {'coalesce_2': 0, 'document_id_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:05:43,574.574] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:05:43,575.575] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:05:43] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 12:06:14,411.411] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:06:14,412.412] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:06:14,412.412] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1146s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:06:14,414.414] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 12:06:14,414.414] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1146s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 12, 6, 14, 414063), 'document_id': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:06:14,415.415] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:06:14,417.417] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:06:14,417.417] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:06:14,417.417] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1278s ago] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:06:14,456.456] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:06:14,457.457] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:06:14] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8/enabled HTTP/1.1" 200 -
[2024-10-11 12:07:40,752.752] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:07:41,059.059] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:07:45,006.006] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:07:45,009.009] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:09:47,916.916] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:09:48,293.293] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:09:52,755.755] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:09:52,758.758] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:10:02,125.125] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:10:02,395.395] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:10:06,338.338] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:10:06,341.341] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:10:44,409.409] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:10:44,658.658] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:10:48,281.281] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:10:48,284.284] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:10:54,241.241] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:10:54,514.514] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:10:58,296.296] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:10:58,298.298] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:17:14,578.578] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:17:14,854.854] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:17:18,362.362] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:17:18,364.364] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:17:58,982.982] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:17:59,313.313] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:18:03,034.034] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:18:03,037.037] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:20:27,175.175] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 12:20:27,440.440] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:20:31,351.351] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:20:31,353.353] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:35:39,221.221] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 12:35:39,221.221] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 12:35:39,222.222] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 12:35:44,482.482] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 12:35:44,485.485] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 12:36:23,606.606] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 12:36:23,607.607] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 12:36:23,607.607] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 12:36:23,608.608] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 12:36:23,609.609] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 12:36:23,609.609] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 12:36:23,610.610] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:36:23,611.611] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:36:23,611.611] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:36:23,613.613] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 12:36:23,613.613] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 12:36:23,616.616] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 12:36:23,616.616] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:36:23,617.617] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 12:36:23,617.617] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'coalesce_2': 0, 'document_id_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:36:23,618.618] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:36:23,619.619] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:36:23] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 12:36:28,757.757] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:36:28,757.757] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:36:28,757.757] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:36:28,758.758] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 12:36:28,758.758] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'id': UUID('c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8')}
[2024-10-11 12:36:28,759.759] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:36:28,794.794] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:36:28] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c47a16fd-7d4f-4f34-a5f0-84a382ab7ad8/delete HTTP/1.1" 200 -
[2024-10-11 12:36:34,826.826] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:36:34,826.826] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:36:34,826.826] base.py -> _exec_single_context line:1908 [INFO]: [cached since 11.22s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:36:34,827.827] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 12:36:34,827.827] base.py -> _exec_single_context line:1908 [INFO]: [cached since 11.21s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 12:36:34,828.828] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 12:36:34,828.828] base.py -> _exec_single_context line:1908 [INFO]: [cached since 11.21s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:36:34,830.830] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:36:34,830.830] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:36:34] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 12:36:57,125.125] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:36:57,125.125] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:36:57,125.125] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.51s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:36:57,127.127] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 12:36:57,127.127] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 12:36:57,129.129] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 12:36:57,129.129] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00017s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 12:36:57,130.130] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:36:57,133.133] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:36:57,134.134] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 12:36:57,134.134] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00017s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 12:36:57,135.135] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 12:36:57,135.135] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 12:36:57,137.137] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 12:36:57,137.137] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('50a45b85-0ea8-4478-b996-169a15066122')}
[2024-10-11 12:36:57,138.138] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 12:36:57,138.138] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('50a45b85-0ea8-4478-b996-169a15066122'), 'batch': '20241011123657325094', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 12:36:57,139.139] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:36:57,141.141] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:36:57,141.141] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:36:57,141.141] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:36:57,163.163] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:36:57,164.164] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:36:57] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 12:37:11,768.768] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:37:11,768.768] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 12:37:11,768.768] base.py -> _exec_single_context line:1908 [INFO]: [cached since 48.16s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:37:11,769.769] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 12:37:11,770.770] base.py -> _exec_single_context line:1908 [INFO]: [cached since 48.16s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 12:37:11,770.770] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 12:37:11,770.770] base.py -> _exec_single_context line:1908 [INFO]: [cached since 48.15s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 12:37:11,771.771] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 12:37:11,771.771] base.py -> _exec_single_context line:1908 [INFO]: [cached since 48.15s ago] {'coalesce_2': 0, 'document_id_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:11,772.772] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:37:11,772.772] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:37:11] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 12:37:19,138.138] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:37:19,138.138] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:37:19,138.138] base.py -> _exec_single_context line:1908 [INFO]: [cached since 50.38s ago] {'pk_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:19,141.141] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 12:37:19,142.142] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 12, 37, 19, 141665), 'document_id': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:19,142.142] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:37:19,145.145] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:37:19,145.145] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:37:19,146.146] base.py -> _exec_single_context line:1908 [INFO]: [cached since 22s ago] {'pk_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:19,187.187] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:37:19,187.187] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:37:19] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c0c00b41-1e03-4372-958d-e279186d7074/enabled HTTP/1.1" 200 -
[2024-10-11 12:37:42,020.020] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:37:42,020.020] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:37:42,020.020] base.py -> _exec_single_context line:1908 [INFO]: [cached since 73.26s ago] {'pk_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:42,021.021] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 12:37:42,021.021] base.py -> _exec_single_context line:1908 [INFO]: [cached since 22.88s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:42,022.022] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:37:42,025.025] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:37:42,025.025] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:37:42,025.025] base.py -> _exec_single_context line:1908 [INFO]: [cached since 44.88s ago] {'pk_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:42,063.063] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 12:37:42,064.064] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:37:42] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c0c00b41-1e03-4372-958d-e279186d7074/enabled HTTP/1.1" 200 -
[2024-10-11 12:37:50,422.422] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 12:37:50,423.423] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 12:37:50,423.423] base.py -> _exec_single_context line:1908 [INFO]: [cached since 81.67s ago] {'pk_1': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:50,424.424] base.py -> _exec_single_context line:1903 [INFO]: DELETE FROM document WHERE document.id = %(id)s::UUID
[2024-10-11 12:37:50,424.424] base.py -> _exec_single_context line:1908 [INFO]: [cached since 81.66s ago] {'id': UUID('c0c00b41-1e03-4372-958d-e279186d7074')}
[2024-10-11 12:37:50,424.424] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 12:37:50,442.442] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 12:37:50] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c0c00b41-1e03-4372-958d-e279186d7074/delete HTTP/1.1" 200 -
[2024-10-11 13:21:39,242.242] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 13:21:39,580.580] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:21:43,158.158] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:21:43,161.161] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:21:56,005.005] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 13:21:56,300.300] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:21:59,706.706] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:21:59,709.709] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:22:01,122.122] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 13:22:01,382.382] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:22:04,662.662] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:22:04,665.665] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:22:35,803.803] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 13:22:36,060.060] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:22:39,540.540] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:22:39,542.542] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:22:55,719.719] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 13:22:55,986.986] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:22:59,316.316] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:22:59,320.320] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:24:42,657.657] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 13:24:42,937.937] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:24:46,233.233] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:24:46,235.235] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:24:57,150.150] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 13:24:57,454.454] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:25:00,722.722] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:25:00,725.725] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:25:28,472.472] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:25:28,753.753] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:25:32,076.076] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:25:32,079.079] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:25:56,383.383] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:25:56,685.685] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:25:59,970.970] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:25:59,972.972] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:26:13,903.903] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:26:14,157.157] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:26:17,505.505] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:26:17,507.507] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:27:35,728.728] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:27:36,003.003] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:27:39,501.501] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:27:39,506.506] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:27:51,179.179] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:27:51,430.430] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:27:54,775.775] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:27:54,778.778] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:29:34,843.843] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:29:35,119.119] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:29:38,407.407] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:29:38,410.410] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:30:02,666.666] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\entity\\cache_entity.py', reloading
[2024-10-11 13:30:02,925.925] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:30:08,002.002] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:30:08,005.005] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:30:24,352.352] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:30:24,638.638] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:30:27,904.904] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:30:27,907.907] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:30:37,345.345] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:30:37,598.598] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:30:40,923.923] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:30:40,926.926] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:32:07,114.114] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:32:07,382.382] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:32:10,752.752] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:32:10,754.754] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:32:30,458.458] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:32:30,721.721] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:32:34,168.168] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:32:34,171.171] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:32:36,788.788] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:32:37,038.038] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:32:40,474.474] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:32:40,477.477] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:32:49,911.911] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:32:50,174.174] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:32:53,868.868] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:32:53,871.871] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:32:58,720.720] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:32:58,993.993] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:33:02,366.366] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:33:02,370.370] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:33:59,870.870] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:34:00,156.156] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:34:03,473.473] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:34:03,476.476] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:34:10,658.658] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:34:10,973.973] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:34:14,329.329] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:34:14,332.332] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:34:15,699.699] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:34:15,960.960] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:34:19,209.209] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:34:19,212.212] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:34:28,684.684] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:34:29,003.003] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:34:32,292.292] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:34:32,295.295] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:37:38,181.181] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:37:38,487.487] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:37:41,750.750] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:37:41,752.752] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:39:14,897.897] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:39:15,186.186] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:39:18,524.524] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:39:18,527.527] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:39:21,031.031] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:39:21,359.359] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:39:24,739.739] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:39:24,741.741] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:39:43,240.240] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:39:43,500.500] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:40:20,198.198] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:40:50,099.099] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:40:53,397.397] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:40:53,399.399] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:44:28,145.145] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:44:28,401.401] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:44:31,719.719] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:44:31,722.722] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:44:52,535.535] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:44:52,788.788] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:44:58,809.809] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:45:02,364.364] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:45:02,368.368] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:45:32,337.337] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:45:32,667.667] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:45:41,122.122] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:45:44,392.392] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:45:44,394.394] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:45:54,978.978] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:45:55,296.296] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:45:58,593.593] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:45:58,595.595] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:46:56,091.091] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 13:46:56,393.393] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:46:59,873.873] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:46:59,876.876] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 139-858-996
[2024-10-11 13:47:15,002.002] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\__init__.py', reloading
[2024-10-11 13:47:15,264.264] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:47:18,602.602] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:47:18,604.604] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 139-858-996
[2024-10-11 13:48:26,390.390] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 13:48:26,711.711] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:48:30,449.449] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:48:30,452.452] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:48:30,710.710] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 13:48:30,974.974] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:48:34,658.658] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:48:34,660.660] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:48:47,268.268] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 13:48:47,268.268] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:48:47,269.269] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 13:48:47,269.269] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:48:47,270.270] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 13:48:47,270.270] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:48:47,270.270] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:48:47,272.272] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 13:48:47,272.272] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:48:47,278.278] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:48:47,278.278] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00029s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 13:48:47,282.282] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 13:48:47,282.282] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:48:47,284.284] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:48:47,284.284] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:48:47] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 13:48:50,376.376] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:48:50,376.376] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 13:48:50,376.376] base.py -> _exec_single_context line:1908 [INFO]: [cached since 3.104s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:48:50,379.379] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2024-10-11 13:48:50,380.380] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00031s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'}
[2024-10-11 13:48:50,382.382] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2024-10-11 13:48:50,383.383] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2024-10-11 13:48:50,384.384] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:48:50,387.387] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:48:50,388.388] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2024-10-11 13:48:50,388.388] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 1}
[2024-10-11 13:48:50,398.398] base.py -> _exec_single_context line:1903 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2024-10-11 13:48:50,398.398] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'pk_1': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7')}
[2024-10-11 13:48:50,400.400] base.py -> _exec_single_context line:1903 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2024-10-11 13:48:50,400.400] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'pk_1': UUID('26afc347-1246-468c-982f-df18be043b25')}
[2024-10-11 13:48:50,402.402] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2024-10-11 13:48:50,402.402] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'upload_file_id': UUID('a3721c3d-9c1e-4ea6-9ac2-f083af0b96b7'), 'process_rule_id': UUID('26afc347-1246-468c-982f-df18be043b25'), 'batch': '20241011134850802214', 'name': 'LLMOps é¡¹ç›®æç¤ºè¯å¤§å…¨.md', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2024-10-11 13:48:50,403.403] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:48:50,425.425] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:48:50,426.426] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:48:50,426.426] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:48:50,493.493] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:48:50,494.494] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:48:50] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents HTTP/1.1" 200 -
[2024-10-11 13:49:01,031.031] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:49:01,032.032] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 13:49:01,032.032] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.76s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:49:01,034.034] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:49:01,034.034] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.76s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 13:49:01,035.035] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 13:49:01,035.035] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.75s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:49:01,037.037] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 13:49:01,037.037] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:01,038.038] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:49:01,038.038] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:49:01] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 13:49:36,950.950] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:49:36,951.951] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:49:36,951.951] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:36,955.955] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:49:36,955.955] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 13:49:36,958.958] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 13:49:36,958.958] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00033s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:36,961.961] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:49:36,962.962] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:49:36] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 13:49:49,714.714] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:49:49,715.715] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:49:49,715.715] base.py -> _exec_single_context line:1908 [INFO]: [cached since 12.76s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:49,716.716] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:49:49,717.717] base.py -> _exec_single_context line:1908 [INFO]: [cached since 12.76s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 20}
[2024-10-11 13:49:49,717.717] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 13:49:49,719.719] base.py -> _exec_single_context line:1908 [INFO]: [cached since 12.76s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:49,720.720] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:49:49,720.720] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:49:49] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=2 HTTP/1.1" 200 -
[2024-10-11 13:49:54,049.049] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:49:54,050.050] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:49:54,050.050] base.py -> _exec_single_context line:1908 [INFO]: [cached since 17.1s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:54,051.051] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:49:54,052.052] base.py -> _exec_single_context line:1908 [INFO]: [cached since 17.1s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 2, 'param_2': 2}
[2024-10-11 13:49:54,053.053] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 13:49:54,053.053] base.py -> _exec_single_context line:1908 [INFO]: [cached since 17.09s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:49:54,054.054] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:49:54,055.055] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:49:54] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=2&page_size=2 HTTP/1.1" 200 -
[2024-10-11 13:50:06,946.946] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:50:06,947.947] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:50:06,947.947] base.py -> _exec_single_context line:1908 [INFO]: [cached since 30s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:50:06,948.948] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:50:06,949.949] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 13:50:06,951.951] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 13:50:06,951.951] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%'}
[2024-10-11 13:50:06,953.953] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:50:06,954.954] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:50:06] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=llm HTTP/1.1" 200 -
[2024-10-11 13:50:24,211.211] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:50:24,211.211] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 13:50:24,212.212] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.94s ago] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:50:24,213.213] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:50:24,213.213] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.94s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 13:50:24,215.215] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 13:50:24,215.215] base.py -> _exec_single_context line:1908 [INFO]: [cached since 96.93s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:50:24,216.216] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 13:50:24,216.216] base.py -> _exec_single_context line:1908 [INFO]: [cached since 83.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:50:24,217.217] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:50:24,218.218] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:50:24] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 13:51:14,904.904] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 13:51:14,930.930] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:51:14] "[35m[1mPOST /datasets/:dataset_id/documents/:document_id/segments/:segment_id/enabled HTTP/1.1[0m" 500 -
[2024-10-11 13:51:40,661.661] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:51:40,663.663] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:51:40,663.663] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:51:40,667.667] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:51:40,667.667] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 13, 51, 40, 666058), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:51:40,668.668] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:51:40,669.669] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:51:40,671.671] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:51:40,671.671] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:51:40,673.673] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:51:40,673.673] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:51:40,675.675] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:51:40,675.675] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00037s] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["f7359447-298d-4831-9ddd-c4779f1219e6", "83f4 ... (6067 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["c1865914-7008-4309-b2eb-e0a4ff35590b", "aa7cd1d3-772b-421b-aaea-39a7dc36f519"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:51:40,676.676] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:51:40,678.678] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:51:40,679.679] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:51:40,679.679] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.00802s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:51:40,684.684] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:51:40,684.684] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:51:40] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:51:54,901.901] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:51:54,901.901] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:51:54,902.902] base.py -> _exec_single_context line:1908 [INFO]: [cached since 138s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:51:54,903.903] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:51:54,903.903] base.py -> _exec_single_context line:1908 [INFO]: [cached since 108s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 13:51:54,904.904] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 13:51:54,904.904] base.py -> _exec_single_context line:1908 [INFO]: [cached since 108s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%'}
[2024-10-11 13:51:54,905.905] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:51:54,906.906] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:51:54] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=llm HTTP/1.1" 200 -
[2024-10-11 13:52:21,972.972] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:52:21,972.972] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:52:21,972.972] base.py -> _exec_single_context line:1908 [INFO]: [cached since 41.31s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:52:21,973.973] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(dataset_id, document_id, segment_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 105, in update_segment_enabled
    raise FailException(f"ç‰‡æ®µçŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}çŠ¶æ€")
internal.exception.exception.FailException
[2024-10-11 13:52:21,975.975] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:52:21,975.975] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:52:21] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:52:27,153.153] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:52:27,154.154] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:52:27,154.154] base.py -> _exec_single_context line:1908 [INFO]: [cached since 46.49s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:52:27,155.155] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:52:27,155.155] base.py -> _exec_single_context line:1908 [INFO]: [cached since 46.49s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:52:27,156.156] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:52:27,158.158] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:52:27,158.158] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:52:27,158.158] base.py -> _exec_single_context line:1908 [INFO]: [cached since 46.49s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:52:27,159.159] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:52:27,159.159] base.py -> _exec_single_context line:1908 [INFO]: [cached since 46.49s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:52:27,161.161] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 13:52:27,161.161] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:52:27,161.161] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:52:27,161.161] base.py -> _exec_single_context line:1908 [INFO]: [cached since 46.49s ago] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce0256e1-f6fb-440d-b990-46c5aea86836", "90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f4 ... (6531 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:52:27,162.162] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:52:27,184.184] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:52:27,185.185] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:52:27,185.185] base.py -> _exec_single_context line:1908 [INFO]: [cached since 46.51s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:52:27,199.199] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:52:27,199.199] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:52:27] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:53:05,129.129] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:53:05,130.130] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:53:05,130.130] base.py -> _exec_single_context line:1908 [INFO]: [cached since 84.47s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:05,132.132] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:53:05,132.132] base.py -> _exec_single_context line:1908 [INFO]: [cached since 84.47s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 13, 53, 5, 132007), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:05,132.132] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:53:05,136.136] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:53:05,136.136] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:53:05,136.136] base.py -> _exec_single_context line:1908 [INFO]: [cached since 84.47s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:05,138.138] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:53:05,138.138] base.py -> _exec_single_context line:1908 [INFO]: [cached since 84.46s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:53:05,139.139] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:53:05,139.139] base.py -> _exec_single_context line:1908 [INFO]: [cached since 84.46s ago] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f44637-2ce2-42c7-83a0-56c64e74ea93", "f735 ... (6067 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["aa7cd1d3-772b-421b-aaea-39a7dc36f519", "c1865914-7008-4309-b2eb-e0a4ff35590b"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:53:05,140.140] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:53:05,142.142] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:53:05,142.142] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:53:05,142.142] base.py -> _exec_single_context line:1908 [INFO]: [cached since 84.47s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:05,147.147] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:53:05,148.148] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:53:05] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:53:27,797.797] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:53:27,797.797] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:53:27,797.797] base.py -> _exec_single_context line:1908 [INFO]: [cached since 107.1s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:27,799.799] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:53:27,799.799] base.py -> _exec_single_context line:1908 [INFO]: [cached since 107.1s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:27,799.799] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:53:27,801.801] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:53:27,802.802] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:53:27,802.802] base.py -> _exec_single_context line:1908 [INFO]: [cached since 107.1s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:27,803.803] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:53:27,803.803] base.py -> _exec_single_context line:1908 [INFO]: [cached since 107.1s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:53:27,804.804] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 13:53:27,804.804] base.py -> _exec_single_context line:1908 [INFO]: [cached since 60.64s ago] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:27,805.805] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:53:27,805.805] base.py -> _exec_single_context line:1908 [INFO]: [cached since 107.1s ago] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce0256e1-f6fb-440d-b990-46c5aea86836", "90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f4 ... (6531 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:53:27,805.805] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:53:27,807.807] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:53:27,807.807] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:53:27,807.807] base.py -> _exec_single_context line:1908 [INFO]: [cached since 107.1s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:53:27,841.841] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:53:27,842.842] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:53:27] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:54:48,450.450] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:54:48,451.451] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:54:48,451.451] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.8s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:54:48,453.453] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:54:48,453.453] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.8s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 13, 54, 48, 453452), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:54:48,454.454] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:54:48,458.458] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:54:48,458.458] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:54:48,458.458] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.8s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:54:48,459.459] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:54:48,459.459] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.8s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:54:48,460.460] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:54:48,461.461] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.8s ago] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f44637-2ce2-42c7-83a0-56c64e74ea93", "f735 ... (6067 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["aa7cd1d3-772b-421b-aaea-39a7dc36f519", "c1865914-7008-4309-b2eb-e0a4ff35590b"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:54:48,462.462] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:54:48,488.488] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:54:48,489.489] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:54:48,489.489] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.8s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:54:48,493.493] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:54:48,494.494] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:54:48] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:55:26,582.582] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 13:55:26,888.888] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:55:30,725.725] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:55:30,728.728] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:55:37,705.705] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:55:37] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/hit HTTP/1.1" 200 -
[2024-10-11 13:55:49,274.274] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 13:55:49,275.275] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:55:49,275.275] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 13:55:49,276.276] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:55:49,276.276] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 13:55:49,276.276] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:55:49,277.277] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:55:49,280.280] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:55:49,280.280] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:55:49,284.284] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:55:49,284.284] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:55:49,285.285] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:55:49,289.289] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:55:49,290.290] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:55:49,290.290] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:55:49,292.292] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:55:49,292.292] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:55:49,294.294] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 13:55:49,294.294] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:55:49,295.295] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:55:49,295.295] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce0256e1-f6fb-440d-b990-46c5aea86836", "90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f4 ... (6531 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:55:49,296.296] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:55:49,324.324] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:55:49,324.324] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:55:49,325.325] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.03436s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:55:49,329.329] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:55:49,330.330] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:55:49] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:55:53,047.047] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:55:53] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/hit HTTP/1.1" 200 -
[2024-10-11 13:56:05,726.726] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 13:56:06,016.016] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:56:09,976.976] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:56:09,979.979] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:56:10,132.132] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 13:56:10,132.132] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:56:10,133.133] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 13:56:10,133.133] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:56:10,134.134] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 13:56:10,134.134] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:56:10,135.135] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:10,138.138] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:10,138.138] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00017s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:10,139.139] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(dataset_id, document_id, segment_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 105, in update_segment_enabled
    raise FailException(f"ç‰‡æ®µçŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}çŠ¶æ€")
internal.exception.exception.FailException
[2024-10-11 13:56:10,141.141] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:56:10,141.141] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:56:10] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:56:12,189.189] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:12,189.189] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:12,189.189] base.py -> _exec_single_context line:1908 [INFO]: [cached since 2.051s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:12,190.190] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 66, in update_segment_enabled
    self.segment_service.update_segment_enabled(dataset_id, document_id, segment_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 105, in update_segment_enabled
    raise FailException(f"ç‰‡æ®µçŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}çŠ¶æ€")
internal.exception.exception.FailException
[2024-10-11 13:56:12,190.190] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:56:12,190.190] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:56:12] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:56:15,300.300] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:15,301.301] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:15,301.301] base.py -> _exec_single_context line:1908 [INFO]: [cached since 5.164s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:15,305.305] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:56:15,306.306] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 13, 56, 15, 304737), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:15,307.307] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:56:15,309.309] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:15,310.310] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:15,311.311] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:15,313.313] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:56:15,313.313] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:56:15,315.315] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:56:15,315.315] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f44637-2ce2-42c7-83a0-56c64e74ea93", "f735 ... (6067 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["aa7cd1d3-772b-421b-aaea-39a7dc36f519", "c1865914-7008-4309-b2eb-e0a4ff35590b"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:56:15,316.316] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:56:15,318.318] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:15,318.318] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:15,318.318] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.007826s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:15,324.324] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:56:15,324.324] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:56:15] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:56:24,095.095] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:24,098.098] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:56:24,098.098] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:56:24,102.102] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:56:24,102.102] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 13:56:24,105.105] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 13:56:24,105.105] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%'}
[2024-10-11 13:56:24,108.108] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:56:24,108.108] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:56:24] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=llm HTTP/1.1" 200 -
[2024-10-11 13:56:30,717.717] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:30,718.718] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:30,718.718] base.py -> _exec_single_context line:1908 [INFO]: [cached since 20.58s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:30,720.720] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 13:56:30,720.720] base.py -> _exec_single_context line:1908 [INFO]: [cached since 15.41s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:30,721.721] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:56:30,723.723] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:30,724.724] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:30,724.724] base.py -> _exec_single_context line:1908 [INFO]: [cached since 15.41s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:30,725.725] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 13:56:30,725.725] base.py -> _exec_single_context line:1908 [INFO]: [cached since 15.41s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 13:56:30,727.727] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 13:56:30,727.727] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:30,728.728] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 13:56:30,728.728] base.py -> _exec_single_context line:1908 [INFO]: [cached since 15.41s ago] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce0256e1-f6fb-440d-b990-46c5aea86836", "90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["f735 ... (6531 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 13:56:30,729.729] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 13:56:30,748.748] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:30,748.748] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:56:30,748.748] base.py -> _exec_single_context line:1908 [INFO]: [cached since 15.44s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:56:30,754.754] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:56:30,755.755] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:56:30] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 13:56:34,114.114] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:56:34,114.114] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 13:56:34,115.115] base.py -> _exec_single_context line:1908 [INFO]: [cached since 10.02s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 13:56:34,117.117] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 13:56:34,117.117] base.py -> _exec_single_context line:1908 [INFO]: [cached since 10.02s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 13:56:34,119.119] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 13:56:34,119.119] base.py -> _exec_single_context line:1908 [INFO]: [cached since 10.01s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%'}
[2024-10-11 13:56:34,122.122] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:56:34,122.122] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:56:34] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=llm HTTP/1.1" 200 -
[2024-10-11 13:57:13,236.236] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:57:13,236.236] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:57:13,237.237] base.py -> _exec_single_context line:1908 [INFO]: [cached since 63.1s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:57:13,238.238] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 'NoneType' object has no attribute 'id'
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 74, in get_segment
    return success_json(resp.dump(segment))
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\marshmallow\schema.py", line 544, in dump
    processed_obj = self._invoke_dump_processors(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\marshmallow\schema.py", line 1069, in _invoke_dump_processors
    data = self._invoke_processors(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\marshmallow\schema.py", line 1226, in _invoke_processors
    data = processor(data, many=many, **kwargs)
  File "D:\Code\llmops\llmops-api\internal\schema\segment_schema.py", line 85, in process_data
    "id": data.id,
AttributeError: 'NoneType' object has no attribute 'id'
[2024-10-11 13:57:13,240.240] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:57:13,267.267] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:57:13] "[35m[1mGET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836 HTTP/1.1[0m" 500 -
[2024-10-11 13:57:43,133.133] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:57:43,420.420] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:57:47,178.178] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:57:47,183.183] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:57:53,120.120] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 13:57:53,423.423] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 13:57:57,274.274] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 13:57:57,277.277] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 13:57:57,424.424] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 13:57:57,424.424] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:57:57,425.425] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 13:57:57,425.425] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:57:57,425.425] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 13:57:57,426.426] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 13:57:57,426.426] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:57:57,428.428] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:57:57,429.429] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:57:57,431.431] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:57:57,431.431] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:57:57] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836 HTTP/1.1" 200 -
[2024-10-11 13:58:05,907.907] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 13:58:05,907.907] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 13:58:05,907.907] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.479s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 13:58:05,910.910] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 13:58:05,910.910] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 13:58:05] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836 HTTP/1.1" 200 -
[2024-10-11 14:11:07,939.939] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 14:11:08,245.245] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:11:12,186.186] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:11:12,187.187] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:11:15,866.866] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 14:11:16,162.162] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:11:19,650.650] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:11:19,653.653] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:11:21,020.020] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\__init__.py', reloading
[2024-10-11 14:11:21,299.299] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:11:24,676.676] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:11:24,682.682] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:11:36,342.342] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\__init__.py', reloading
[2024-10-11 14:11:36,600.600] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:11:40,107.107] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:11:40,110.110] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:11:50,675.675] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\entity\\cache_entity.py', reloading
[2024-10-11 14:11:50,932.932] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:11:54,242.242] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:11:54,245.245] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:19:16,661.661] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 14:19:16,972.972] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:19:20,403.403] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:19:20,406.406] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:19:41,287.287] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\__init__.py', reloading
[2024-10-11 14:19:41,586.586] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:19:45,096.096] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:19:45,099.099] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:20:31,380.380] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 14:20:31,635.635] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:20:34,993.993] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:20:34,996.996] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:21:25,796.796] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 14:21:26,048.048] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:21:29,472.472] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:21:29,475.475] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:23:09,473.473] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 14:23:09,732.732] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:23:13,272.272] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:23:13,274.274] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 14:47:16,713.713] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 14:47:17,001.001] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 14:47:20,655.655] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 14:47:20,658.658] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:07:56,625.625] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 15:07:56,907.907] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:08:00,158.158] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:08:00,161.161] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:10:07,134.134] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 15:10:07,418.418] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:10:10,775.775] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:10:10,777.777] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:12:51,003.003] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 15:12:51,286.286] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:12:54,647.647] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:12:54,649.649] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:16:29,602.602] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:16:29,900.900] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:16:33,312.312] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:16:33,315.315] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:16:38,097.097] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:16:38,352.352] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:16:41,625.625] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:16:41,628.628] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:16:57,850.850] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\__init__.py', reloading
[2024-10-11 15:16:58,133.133] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:17:01,540.540] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:17:01,543.543] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:17:09,761.761] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 15:17:10,069.069] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:17:13,483.483] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:17:13,486.486] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:18:10,990.990] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 15:18:11,281.281] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:18:14,507.507] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:18:14,510.510] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:22:48,273.273] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:22:48,534.534] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:22:51,743.743] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:22:51,746.746] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:23:20,905.905] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 15:23:20,906.906] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:23:20,907.907] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 15:23:20,907.907] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:23:20,907.907] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 15:23:20,907.907] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:23:20,908.908] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:23:20,911.911] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 15:23:20,911.911] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 15:23:20,916.916] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 15:23:20,916.916] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 15:23:20,919.919] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 15:23:20,920.920] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%'}
[2024-10-11 15:23:20,922.922] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:23:20,923.923] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:23:20] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=llm HTTP/1.1" 200 -
[2024-10-11 15:23:52,711.711] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:23:52,712.712] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 15:23:52,712.712] base.py -> _exec_single_context line:1908 [INFO]: [cached since 31.8s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 15:23:52,714.714] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 15:23:52,714.714] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 15:23:52,718.718] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 15:23:52,718.718] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 15:23:52,721.721] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:23:52,722.722] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:23:52] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 15:23:59,067.067] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:23:59,067.067] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 15:23:59,068.068] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.16s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 15:23:59,069.069] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 15:23:59,069.069] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.15s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%', 'param_1': 20, 'param_2': 0}
[2024-10-11 15:23:59,071.071] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 15:23:59,071.071] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.15s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%llm%'}
[2024-10-11 15:23:59,073.073] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:23:59,074.074] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:23:59] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=llm HTTP/1.1" 200 -
[2024-10-11 15:26:02,863.863] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 15:26:03,190.190] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:26:06,555.555] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:26:06,559.559] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:26:33,005.005] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 15:26:33,291.291] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:26:36,641.641] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:26:36,643.643] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:27:07,695.695] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:27:07,991.991] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:27:12,974.974] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:27:12,977.977] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:28:35,463.463] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:28:35,757.757] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:28:39,131.131] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:28:39,134.134] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:28:45,955.955] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 15:28:45,955.955] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:28:45,956.956] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 15:28:45,956.956] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:28:45,957.957] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 15:28:45,957.957] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:28:45,958.958] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:28:45,960.960] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 15:28:45,960.960] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00032s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 15:28:45,965.965] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 15:28:45,966.966] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00029s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 15:28:45,970.970] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 15:28:45,970.970] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 15:28:45,974.974] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:28:45,974.974] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:28:45] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 15:29:01,268.268] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:29:01,269.269] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:29:01,270.270] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:29:01,272.272] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:29:01,272.272] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:29:01] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836 HTTP/1.1" 200 -
[2024-10-11 15:31:18,561.561] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 15:31:18,869.869] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:31:22,357.357] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:31:22,360.360] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:33:05,572.572] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 15:33:05,864.864] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:33:09,317.317] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:33:09,319.319] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:33:47,276.276] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:33:47,570.570] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:33:51,014.014] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:33:51,017.017] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:36:32,627.627] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:36:32,936.936] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:36:36,171.171] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:36:36,173.173] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:37:57,463.463] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\entity\\cache_entity.py', reloading
[2024-10-11 15:37:57,730.730] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:38:01,057.057] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:38:01,060.060] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:42:08,606.606] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:42:08,909.909] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:42:12,226.226] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:42:12,228.228] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:43:21,219.219] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:43:21,493.493] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:43:25,030.030] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:43:25,033.033] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:44:35,136.136] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:44:35,456.456] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:44:38,889.889] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:44:38,891.891] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:45:48,945.945] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 15:45:49,253.253] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:45:53,005.005] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:45:53,008.008] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:46:28,798.798] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 15:46:29,091.091] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:46:32,838.838] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:46:32,840.840] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:46:37,694.694] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 15:46:37,991.991] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 15:46:41,897.897] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 15:46:41,900.900] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 15:46:59,135.135] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 15:46:59,135.135] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:46:59,136.136] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 15:46:59,136.136] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:46:59,137.137] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 15:46:59,137.137] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 15:46:59,138.138] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:46:59,140.140] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:46:59,140.140] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:46:59,142.142] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:46:59,142.142] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:46:59] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836 HTTP/1.1" 200 -
[2024-10-11 15:47:17,012.012] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:47:17,012.012] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:47:17,012.012] base.py -> _exec_single_context line:1908 [INFO]: [cached since 17.87s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:47:17,015.015] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 15:47:17,015.015] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 15, 47, 17, 14801), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:47:17,016.016] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 15:47:17,019.019] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:47:17,020.020] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 15:47:17,020.020] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 15:47:17,022.022] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 15:47:17,022.022] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["f7359447-298d-4831-9ddd-c4779f1219e6", "83f4 ... (6067 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["c1865914-7008-4309-b2eb-e0a4ff35590b", "aa7cd1d3-772b-421b-aaea-39a7dc36f519"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 15:47:17,023.023] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 15:47:17,025.025] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:47:17,026.026] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:47:17,026.026] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:47:17,040.040] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:47:17,040.040] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:47:17] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 15:47:25,063.063] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:47:25,064.064] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:47:25,064.064] base.py -> _exec_single_context line:1908 [INFO]: [cached since 25.92s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:47:25,065.065] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:47:25,065.065] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:47:25] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836 HTTP/1.1" 200 -
[2024-10-11 15:47:35,803.803] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:47:35] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/hit HTTP/1.1" 200 -
[2024-10-11 15:48:40,407.407] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:48:40,408.408] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:48:40,408.408] base.py -> _exec_single_context line:1908 [INFO]: [cached since 101.3s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:48:40,411.411] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 15:48:40,411.411] base.py -> _exec_single_context line:1908 [INFO]: [cached since 83.4s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:48:40,412.412] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 15:48:40,415.415] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:48:40,415.415] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 15:48:40,415.415] base.py -> _exec_single_context line:1908 [INFO]: [cached since 83.39s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 15:48:40,417.417] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 15:48:40,417.417] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:48:40,419.419] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 15:48:40,419.419] base.py -> _exec_single_context line:1908 [INFO]: [cached since 83.4s ago] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce0256e1-f6fb-440d-b990-46c5aea86836", "90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "id": ["83f4 ... (6531 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 15:48:40,421.421] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 15:48:40,424.424] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 15:48:40,424.424] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 15:48:40,425.425] base.py -> _exec_single_context line:1908 [INFO]: [cached since 83.4s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 15:48:40,429.429] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 15:48:40,430.430] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 15:48:40] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 16:34:33,558.558] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 16:34:34,019.019] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:34:38,739.739] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:34:38,742.742] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:34:59,506.506] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 16:34:59,790.790] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:35:03,898.898] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:35:03,901.901] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:35:13,319.319] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 16:35:13,634.634] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:35:18,016.016] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:35:18,020.020] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:36:04,000.000] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 16:36:04,298.298] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:36:08,611.611] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:36:08,614.614] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:36:37,813.813] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:36:38,094.094] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:36:42,501.501] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:36:42,504.504] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:37:06,710.710] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:37:06,974.974] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:37:11,166.166] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:37:11,169.169] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:37:21,671.671] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:37:21,945.945] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:37:26,103.103] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:37:26,105.105] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:38:23,415.415] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:38:23,690.690] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:38:27,844.844] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:38:27,847.847] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:39:00,118.118] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:39:00,412.412] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:39:04,831.831] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:39:04,833.833] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:39:09,611.611] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:39:09,940.940] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:39:14,141.141] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:39:14,143.143] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:39:44,084.084] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\schema\\segment_schema.py', reloading
[2024-10-11 16:39:44,388.388] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:39:48,833.833] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:39:48,835.835] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:40:05,040.040] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 16:40:05,312.312] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:40:09,744.744] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:40:09,747.747] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:40:55,801.801] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\segment_handler.py', reloading
[2024-10-11 16:40:56,078.078] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:41:00,463.463] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:41:00,465.465] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:41:30,338.338] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:41:30,654.654] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:41:34,752.752] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:41:34,755.755] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:41:55,568.568] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:41:55,890.890] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:42:00,315.315] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:42:00,318.318] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:42:31,352.352] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:42:31,714.714] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:42:36,118.118] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:42:36,120.120] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:42:40,963.963] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:42:41,232.232] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:42:45,574.574] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:42:45,577.577] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:42:46,939.939] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:42:47,206.206] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:42:51,440.440] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:42:51,443.443] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:43:00,986.986] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:43:01,298.298] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:43:05,650.650] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:43:05,652.652] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:43:31,002.002] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:43:31,300.300] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:43:35,725.725] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:43:35,728.728] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:44:05,830.830] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:44:06,149.149] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:44:10,525.525] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:44:10,528.528] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:44:21,043.043] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:44:21,354.354] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:44:25,459.459] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:44:25,462.462] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:46:15,725.725] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:46:16,069.069] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:46:19,892.892] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:46:19,895.895] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:46:58,948.948] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:46:59,231.231] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:47:03,252.252] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:47:03,255.255] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:47:10,396.396] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:47:10,719.719] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:47:14,644.644] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:47:14,647.647] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:47:46,926.926] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:47:47,215.215] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:47:51,176.176] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:47:51,179.179] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:48:39,411.411] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:48:39,697.697] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:48:43,667.667] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:48:43,670.670] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:48:45,034.034] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:48:45,336.336] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:48:50,893.893] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 16:48:50,896.896] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 16:53:25,609.609] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 16:53:25,933.933] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:53:47,099.099] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:57:29,707.707] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:58:05,189.189] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 16:58:12,678.678] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:00:21,782.782] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:00:37,597.597] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:00:46,134.134] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:01:15,166.166] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:01:26,862.862] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:02:08,861.861] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:02:12,780.780] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:02:12,783.783] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:02:29,321.321] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:02:29,635.635] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:02:33,665.665] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:02:33,668.668] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:04:26,522.522] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:04:26,850.850] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:08:23,141.141] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:08:27,202.202] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:08:27,205.205] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:08:28,640.640] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:08:28,998.998] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:08:32,925.925] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:08:32,927.927] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:09:30,810.810] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:09:31,108.108] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:09:35,585.585] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:09:35,587.587] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:10:07,838.838] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:10:08,283.283] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:10:12,091.091] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:10:12,094.094] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:11:02,333.333] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:11:02,639.639] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:11:06,558.558] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:11:06,562.562] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:11:38,958.958] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:11:39,341.341] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:11:43,252.252] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:11:43,254.254] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:12:12,037.037] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:12:12,362.362] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:12:16,521.521] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:12:16,524.524] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:13:11,529.529] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:13:11,818.818] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:13:15,598.598] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:13:15,601.601] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:13:22,699.699] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:13:22,996.996] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:13:27,457.457] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:13:27,460.460] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:13:56,469.469] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:13:56,770.770] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:14:01,268.268] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:14:01,271.271] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:14:09,665.665] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:14:09,950.950] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:14:13,980.980] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:14:13,983.983] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:14:18,803.803] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:14:19,304.304] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:14:23,401.401] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:14:23,405.405] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:14:38,978.978] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:14:39,317.317] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:14:43,238.238] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:14:43,242.242] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:17:15,164.164] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\router\\router.py', reloading
[2024-10-11 17:17:15,541.541] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:17:19,314.314] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:17:19,317.317] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:17:44,856.856] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2024-10-11 17:17:44,883.883] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:17:44] "[35m[1mPOST /datasets/:dataset_id/documents/:document_id/segments HTTP/1.1[0m" 500 -
[2024-10-11 17:17:52,392.392] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:17:52] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 17:18:18,453.453] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 17:18:18,453.453] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:18:18,454.454] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 17:18:18,454.454] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:18:18,455.455] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 17:18:18,455.455] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:18:18,456.456] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:18:18,459.459] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:18:18,459.459] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00031s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:18:18,461.461] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: SQL expression element or literal value expected, got <Document c4c940e9-42af-4150-9141-814b1d37efce>.
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 794, in _literal_coercion
    return expr._bind_param(operator, element, type_=bindparam_type)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 4525, in _bind_param
    return BindParameter(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 2029, in __init__
    self.type = _compared_to_type.coerce_compared_value(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 3578, in coerce_compared_value
    return super().coerce_compared_value(op, value)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\type_api.py", line 1035, in coerce_compared_value
    _coerced_type = _resolve_value_to_type(value)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 3767, in _resolve_value_to_type
    raise exc.ArgumentError(
sqlalchemy.exc.ArgumentError: Object <Document c4c940e9-42af-4150-9141-814b1d37efce> is not legal as a SQL literal value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 40, in create_segment
    self.segment_service.create_segment(dataset_id, document_id, req)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 181, in create_segment
    Segment.document_id == document,
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 582, in __eq__
    return self.operate(eq, other)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\attributes.py", line 453, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 582, in __eq__
    return self.operate(eq, other)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\orm\properties.py", line 479, in operate
    return op(self.__clause_element__(), *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\annotation.py", line 371, in __eq__
    return self.__element.__class__.__eq__(self, other)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 582, in __eq__
    return self.operate(eq, other)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 1511, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 582, in __eq__
    return self.operate(eq, other)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\type_api.py", line 194, in operate
    return op_fn(self.expr, op, *other, **addtl_kw)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\default_comparator.py", line 121, in _boolean_compare
    obj = coercions.expect(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 396, in expect
    resolved = impl._literal_coercion(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 796, in _literal_coercion
    self._raise_for_expected(element, err=err)
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 782, in _raise_for_expected
    return super()._raise_for_expected(
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 518, in _raise_for_expected
    raise exc.ArgumentError(msg, code=code) from err
sqlalchemy.exc.ArgumentError: SQL expression element or literal value expected, got <Document c4c940e9-42af-4150-9141-814b1d37efce>.
[2024-10-11 17:18:18,472.472] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:18:18,524.524] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:18:18] "[35m[1mPOST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1[0m" 500 -
[2024-10-11 17:18:38,067.067] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:18:38,398.398] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:18:42,397.397] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:18:42,399.399] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:19:15,365.365] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 17:19:15,365.365] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:19:15,366.366] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 17:19:15,366.366] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:19:15,367.367] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 17:19:15,367.367] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:19:15,369.369] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:15,372.372] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:19:15,372.372] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:15,377.377] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:19:15,378.378] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00029s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:19:15,382.382] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 17:19:15,382.382] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:15,385.385] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:19:15,386.386] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:19:15] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 17:19:34,048.048] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:34,049.049] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:19:34,049.049] base.py -> _exec_single_context line:1908 [INFO]: [cached since 18.68s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:34,052.052] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:19:34,052.052] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:34,054.054] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(character_count)s, %(token_count)s, %(keywords)s, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.content, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2024-10-11 17:19:34,055.055] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'node_id': '753079e5-0bd6-43ca-bb8c-c9f769134697', 'position': 15, 'character_count': 11, 'token_count': 16, 'keywords': '["\\u6155\\u8bfe", "\\u7a0b\\u5e8f\\u5458", "\\u5de5\\u5382"]', 'hash': '8a3aa27bd72d41601fba5ca067a30c1f3864b47b99989b1a6561a3ec1a672287', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2024, 10, 11, 17, 19, 34, 53247), 'indexing_completed_at': datetime.datetime(2024, 10, 11, 17, 19, 34, 53247), 'completed_at': datetime.datetime(2024, 10, 11, 17, 19, 34, 53247), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2024-10-11 17:19:34,056.056] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:19:34,059.059] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:34,060.060] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:19:34,060.060] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:34,062.062] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:19:34,062.062] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00029s] {'pk_1': UUID('bcee9903-ff10-43c2-9e8f-06c7d271955d')}
[2024-10-11 17:19:35,009.009] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2024-10-11 17:19:35,010.010] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00032s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2024-10-11 17:19:35,012.012] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 17:19:35,012.012] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'character_count': 12127, 'token_count': 6599, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:35,013.013] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:19:35,015.015] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:35,016.016] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:19:35,016.016] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.9542s ago] {'pk_1': UUID('bcee9903-ff10-43c2-9e8f-06c7d271955d')}
[2024-10-11 17:19:35,019.019] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:19:35,019.019] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:19:35,021.021] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:19:35,021.021] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'id_1_1': UUID('bcee9903-ff10-43c2-9e8f-06c7d271955d')}
[2024-10-11 17:19:35,023.023] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:19:35,023.023] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce0256e1-f6fb-440d-b990-46c5aea86836", "90e6f60b-25f3-48c9-ae26-8c5b645b2e72"], "db": ["ce02 ... (6718 characters truncated) ... 2-9e8f-06c7d271955d"], "\\u7a0b\\u5e8f\\u5458": ["bcee9903-ff10-43c2-9e8f-06c7d271955d"], "\\u5de5\\u5382": ["bcee9903-ff10-43c2-9e8f-06c7d271955d"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:19:35,023.023] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:19:35,025.025] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:19:35] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 17:19:38,946.946] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:38,947.947] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:19:38,947.947] base.py -> _exec_single_context line:1908 [INFO]: [cached since 23.58s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:38,949.949] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:19:38,949.949] base.py -> _exec_single_context line:1908 [INFO]: [cached since 23.57s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:19:38,950.950] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 17:19:38,951.951] base.py -> _exec_single_context line:1908 [INFO]: [cached since 23.57s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:38,954.954] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:19:38,954.954] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:19:38] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 17:19:49,529.529] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:49,530.530] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:19:49,530.530] base.py -> _exec_single_context line:1908 [INFO]: [cached since 34.16s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:49,533.533] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:19:49,533.533] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%æ…•è¯¾%', 'param_1': 20, 'param_2': 0}
[2024-10-11 17:19:49,536.536] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 17:19:49,536.536] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%æ…•è¯¾%'}
[2024-10-11 17:19:49,538.538] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:19:49,538.538] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:19:49] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=æ…•è¯¾ HTTP/1.1" 200 -
[2024-10-11 17:19:52,992.992] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:19:52,993.993] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:19:52,993.993] base.py -> _exec_single_context line:1908 [INFO]: [cached since 37.62s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:52,995.995] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:19:52,995.995] base.py -> _exec_single_context line:1908 [INFO]: [cached since 37.62s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:19:52,996.996] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 17:19:52,998.998] base.py -> _exec_single_context line:1908 [INFO]: [cached since 37.62s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:19:53,001.001] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:19:53,001.001] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:19:53] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 17:20:31,724.724] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 17:20:32,064.064] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:20:36,013.013] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:20:36,016.016] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:22:19,102.102] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 17:22:19,102.102] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:22:19,103.103] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 17:22:19,103.103] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:22:19,104.104] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 17:22:19,104.104] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:22:19,105.105] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:22:19,108.108] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:22:19,108.108] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:19,113.113] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:22:19,113.113] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:19,116.116] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2024-10-11 17:22:19,117.117] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00033s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'node_id': '211f7c55-01f1-4f6b-a365-586dc0c9d7ad', 'position': 16, 'content': 'Lesstionï¼Œè½»åŠ¨ç¬”è®°ï¼Œç”¨AIä¸ºç¬”è®°èµ‹èƒ½', 'character_count': 22, 'token_count': 20, 'keywords': '["\\u7b14\\u8bb0", "AI", "Lesstion"]', 'hash': '9fa344e19467cc7b37d8bf66eecc5381d7a9a7954e3b5d165112a1730091faf5', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2024, 10, 11, 17, 22, 19, 114153), 'indexing_completed_at': datetime.datetime(2024, 10, 11, 17, 22, 19, 114153), 'completed_at': datetime.datetime(2024, 10, 11, 17, 22, 19, 114153), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2024-10-11 17:22:19,129.129] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:22:19,167.167] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:22:19,169.169] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:22:19,169.169] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:19,171.171] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:22:19,172.172] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'pk_1': UUID('810c882b-b1be-4cbb-aa28-4f6efacf0e72')}
[2024-10-11 17:22:20,154.154] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2024-10-11 17:22:20,154.154] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00028s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2024-10-11 17:22:20,156.156] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 17:22:20,157.157] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'character_count': 12149, 'token_count': 6619, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:20,157.157] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:22:20,160.160] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:22:20,160.160] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:22:20,160.160] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.9885s ago] {'pk_1': UUID('810c882b-b1be-4cbb-aa28-4f6efacf0e72')}
[2024-10-11 17:22:20,164.164] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:22:20,164.164] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:22:20,165.165] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:22:20,166.166] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'id_1_1': UUID('810c882b-b1be-4cbb-aa28-4f6efacf0e72')}
[2024-10-11 17:22:20,167.167] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:22:20,167.167] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'keyword_table': '{"UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6f60b-25f3-48c9-ae26-8c5b645b2e72", "ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce02 ... (6880 characters truncated) ... bb0": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72"], "AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72"], "Lesstion": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:22:20,168.168] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:22:20,170.170] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:22:20] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 17:22:26,387.387] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:22:26,387.387] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:22:26,387.387] base.py -> _exec_single_context line:1908 [INFO]: [cached since 7.28s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:26,390.390] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:22:26,390.390] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:22:26,394.394] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 17:22:26,394.394] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:26,398.398] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:22:26,399.399] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:22:26] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 17:22:32,254.254] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:22:32,255.255] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:22:32,255.255] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.15s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:22:32,257.257] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:22:32,258.258] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%lesstion%', 'param_1': 20, 'param_2': 0}
[2024-10-11 17:22:32,260.260] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.content ILIKE %(content_1)s) AS anon_1
[2024-10-11 17:22:32,260.260] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'content_1': '%lesstion%'}
[2024-10-11 17:22:32,263.263] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:22:32,263.263] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:22:32] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20&search_word=lesstion HTTP/1.1" 200 -
[2024-10-11 17:24:51,225.225] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:24:51,227.227] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 17:24:51,227.227] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:24:51,231.231] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:24:51,231.231] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:24:51,234.234] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 17:24:51,234.234] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:24:51,235.235] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:24:51,236.236] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:24:51,237.237] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:24:51,237.237] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:24:51] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 17:24:58,256.256] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:24:58,257.257] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:24:58,257.257] base.py -> _exec_single_context line:1908 [INFO]: [cached since 159.1s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:24:58,259.259] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:24:58,259.259] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00021s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:24:58,260.260] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:24:58,261.261] base.py -> _exec_single_context line:1908 [INFO]: [cached since 7.025s ago] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:24:58,261.261] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:24:58,262.262] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:24:58] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce HTTP/1.1" 200 -
[2024-10-11 17:25:26,336.336] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:25:26,336.336] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:25:26,336.336] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.2s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:25:26,338.338] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:25:26,338.338] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:25:26,339.339] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2024-10-11 17:25:26,339.339] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.2s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'node_id': '0e703385-567f-465a-a6d2-1fc6ef5aaaa2', 'position': 17, 'content': 'Lesstionï¼Œè½»åŠ¨ç¬”è®°ï¼Œç”¨AIä¸ºç¬”è®°èµ‹èƒ½', 'character_count': 22, 'token_count': 20, 'keywords': '["\\u7b14\\u8bb0", "AI", "Lesstion"]', 'hash': '9fa344e19467cc7b37d8bf66eecc5381d7a9a7954e3b5d165112a1730091faf5', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2024, 10, 11, 17, 25, 26, 338601), 'indexing_completed_at': datetime.datetime(2024, 10, 11, 17, 25, 26, 338601), 'completed_at': datetime.datetime(2024, 10, 11, 17, 25, 26, 338601), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2024-10-11 17:25:26,339.339] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:25:26,343.343] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:25:26,344.344] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:25:26,344.344] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.2s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:25:26,344.344] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:25:26,345.345] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.2s ago] {'pk_1': UUID('5c4d53e7-c0e5-41b6-88f1-6572e14c7c15')}
[2024-10-11 17:25:27,087.087] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2024-10-11 17:25:27,087.087] base.py -> _exec_single_context line:1908 [INFO]: [cached since 186.9s ago] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2024-10-11 17:25:27,088.088] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 17:25:27,088.088] base.py -> _exec_single_context line:1908 [INFO]: [cached since 186.9s ago] {'character_count': 12171, 'token_count': 6639, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:25:27,089.089] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:25:27,090.090] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:25:27,090.090] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:25:27,091.091] base.py -> _exec_single_context line:1908 [INFO]: [cached since 187.9s ago] {'pk_1': UUID('5c4d53e7-c0e5-41b6-88f1-6572e14c7c15')}
[2024-10-11 17:25:27,093.093] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:25:27,093.093] base.py -> _exec_single_context line:1908 [INFO]: [cached since 186.9s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:25:27,094.094] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:25:27,094.094] base.py -> _exec_single_context line:1908 [INFO]: [cached since 186.9s ago] {'id_1_1': UUID('5c4d53e7-c0e5-41b6-88f1-6572e14c7c15')}
[2024-10-11 17:25:27,095.095] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:25:27,095.095] base.py -> _exec_single_context line:1908 [INFO]: [cached since 186.9s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (7000 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["c1865914-7008-4309-b2eb-e0a4ff35590b", "aa7cd1d3-772b-421b-aaea-39a7dc36f519"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:25:27,096.096] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:25:27,117.117] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:25:27] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 17:25:47,091.091] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:25:47,092.092] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:25:47,092.092] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00024s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:25:47,094.094] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:25:47,094.094] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 17, 25, 47, 93995), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:25:47,095.095] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:25:47,098.098] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:25:47,098.098] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:25:47,098.098] base.py -> _exec_single_context line:1908 [INFO]: [cached since 206.9s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:25:47,099.099] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:25:47,099.099] base.py -> _exec_single_context line:1908 [INFO]: [cached since 206.9s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (6536 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["c1865914-7008-4309-b2eb-e0a4ff35590b", "aa7cd1d3-772b-421b-aaea-39a7dc36f519"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:25:47,100.100] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:25:47,102.102] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:25:47,102.102] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:25:47,102.102] base.py -> _exec_single_context line:1908 [INFO]: [cached since 207.9s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:25:47,111.111] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:25:47,112.112] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:25:47] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:26:16,346.346] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:16,346.346] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:26:16,346.346] base.py -> _exec_single_context line:1908 [INFO]: [cached since 29.25s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:16,347.347] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 73, in update_segment_enabled
    self.segment_service.update_segment_enabled(dataset_id, document_id, segment_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 115, in update_segment_enabled
    raise FailException(f"ç‰‡æ®µçŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}")
internal.exception.exception.FailException
[2024-10-11 17:26:16,348.348] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:26:16,348.348] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:26:16] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:26:20,762.762] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:20,763.763] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:26:20,763.763] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.67s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:20,765.765] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:26:20,765.765] base.py -> _exec_single_context line:1908 [INFO]: [cached since 33.67s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:20,766.766] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:26:20,768.768] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:20,768.768] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:26:20,768.768] base.py -> _exec_single_context line:1908 [INFO]: [cached since 240.6s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:26:20,769.769] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:26:20,769.769] base.py -> _exec_single_context line:1908 [INFO]: [cached since 240.6s ago] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:20,770.770] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:26:20,770.770] base.py -> _exec_single_context line:1908 [INFO]: [cached since 240.6s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (7000 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:26:20,772.772] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:26:20,774.774] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:20,774.774] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:26:20,774.774] base.py -> _exec_single_context line:1908 [INFO]: [cached since 241.6s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:20,779.779] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:26:20,779.779] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:26:20] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:26:42,068.068] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:42,069.069] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:26:42,069.069] base.py -> _exec_single_context line:1908 [INFO]: [cached since 54.98s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:42,071.071] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:26:42,071.071] base.py -> _exec_single_context line:1908 [INFO]: [cached since 54.98s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 17, 26, 42, 71281), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:42,072.072] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:26:42,075.075] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:42,075.075] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:26:42,076.076] base.py -> _exec_single_context line:1908 [INFO]: [cached since 261.9s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:26:42,077.077] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:26:42,077.077] base.py -> _exec_single_context line:1908 [INFO]: [cached since 261.9s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (6536 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["c1865914-7008-4309-b2eb-e0a4ff35590b", "aa7cd1d3-772b-421b-aaea-39a7dc36f519"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:26:42,084.084] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:26:42,103.103] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:26:42,104.104] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:26:42,104.104] base.py -> _exec_single_context line:1908 [INFO]: [cached since 262.9s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:26:42,110.110] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:26:42,110.110] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:26:42] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:27:10,656.656] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:27:10,656.656] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:27:10,656.656] base.py -> _exec_single_context line:1908 [INFO]: [cached since 83.56s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:27:10,657.657] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 73, in update_segment_enabled
    self.segment_service.update_segment_enabled(dataset_id, document_id, segment_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 115, in update_segment_enabled
    raise FailException(f"ç‰‡æ®µçŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}")
internal.exception.exception.FailException
[2024-10-11 17:27:10,658.658] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:27:10,658.658] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:27:10] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:27:16,498.498] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:27:16,498.498] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:27:16,499.499] base.py -> _exec_single_context line:1908 [INFO]: [cached since 89.41s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:27:16,501.501] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:27:16,501.501] base.py -> _exec_single_context line:1908 [INFO]: [cached since 89.41s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:27:16,501.501] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:27:16,525.525] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:27:16,525.525] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:27:16,525.525] base.py -> _exec_single_context line:1908 [INFO]: [cached since 296.4s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:27:16,527.527] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:27:16,527.527] base.py -> _exec_single_context line:1908 [INFO]: [cached since 296.4s ago] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:27:16,528.528] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:27:16,528.528] base.py -> _exec_single_context line:1908 [INFO]: [cached since 296.4s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (7000 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:27:16,529.529] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:27:16,531.531] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:27:16,531.531] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:27:16,531.531] base.py -> _exec_single_context line:1908 [INFO]: [cached since 297.4s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:27:16,536.536] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:27:16,537.537] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:27:16] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:28:11,636.636] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:28:11,636.636] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:28:11,636.636] base.py -> _exec_single_context line:1908 [INFO]: [cached since 144.5s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:28:11,638.638] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:28:11,639.639] base.py -> _exec_single_context line:1908 [INFO]: [cached since 144.5s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 17, 28, 11, 638071), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:28:11,639.639] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:28:11,641.641] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:28:11,642.642] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:28:11,642.642] base.py -> _exec_single_context line:1908 [INFO]: [cached since 351.5s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:28:11,643.643] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:28:11,643.643] base.py -> _exec_single_context line:1908 [INFO]: [cached since 351.5s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (6536 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["c1865914-7008-4309-b2eb-e0a4ff35590b", "aa7cd1d3-772b-421b-aaea-39a7dc36f519"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:28:11,644.644] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:28:11,646.646] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:28:11,647.647] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:28:11,647.647] base.py -> _exec_single_context line:1908 [INFO]: [cached since 352.5s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:28:11,651.651] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:28:11,652.652] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:28:11] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:39:24,105.105] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 17:39:24,105.105] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 17:39:24,106.106] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:39:27,899.899] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:39:27,902.902] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:39:28,058.058] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 17:39:28,058.058] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:39:28,059.059] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 17:39:28,059.059] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:39:28,060.060] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 17:39:28,060.060] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:39:28,061.061] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:39:28,063.063] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:39:28,063.063] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:39:28,064.064] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\segment_handler.py", line 73, in update_segment_enabled
    self.segment_service.update_segment_enabled(dataset_id, document_id, segment_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\segment_service.py", line 115, in update_segment_enabled
    raise FailException(f"ç‰‡æ®µçŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}")
internal.exception.exception.FailException
[2024-10-11 17:39:28,066.066] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:39:28,066.066] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:39:28] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:39:33,413.413] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:39:33,414.414] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:39:33,414.414] base.py -> _exec_single_context line:1908 [INFO]: [cached since 5.352s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:39:33,419.419] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:39:33,419.419] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:39:33,420.420] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:39:33,445.445] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:39:33,447.447] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:39:33,447.447] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:39:33,449.449] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:39:33,449.449] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:39:33,451.451] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:39:33,451.451] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00034s] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["ce02 ... (7000 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:39:33,452.452] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:39:33,470.470] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:39:33,471.471] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:39:33,471.471] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:39:33,477.477] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:39:33,477.477] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:39:33] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:40:12,379.379] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:40:12,379.379] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:40:12,379.379] base.py -> _exec_single_context line:1908 [INFO]: [cached since 44.32s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:40:12,380.380] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 17:40:12,380.380] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.96s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 17, 40, 12, 380983), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:40:12,381.381] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:40:12,384.384] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:40:12,384.384] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:40:12,384.384] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.94s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:40:12,386.386] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:40:12,386.386] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.94s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "5c4d53e7-c0e5-41b6-88f1-6572e14c7c15"], "UI": ["47895732-7884-4f61-86dc-b05a658c4360"], "__": ["90e6 ... (6536 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["aa7cd1d3-772b-421b-aaea-39a7dc36f519", "c1865914-7008-4309-b2eb-e0a4ff35590b"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:40:12,387.387] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:40:12,389.389] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:40:12,389.389] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:40:12,389.389] base.py -> _exec_single_context line:1908 [INFO]: [cached since 38.92s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 17:40:12,394.394] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:40:12,395.395] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:40:12] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 17:55:14,717.717] _internal.py -> _log line:96 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2024-10-11 17:55:14,717.717] _internal.py -> _log line:96 [INFO]: [33mPress CTRL+C to quit[0m
[2024-10-11 17:55:14,718.718] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 17:55:18,468.468] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 17:55:18,470.470] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 17:55:30,557.557] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 17:55:30,558.558] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:55:30,561.561] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 17:55:30,561.561] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:55:30,562.562] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 17:55:30,562.562] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 17:55:30,564.564] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:55:30,567.567] base.py -> _exec_single_context line:1903 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2024-10-11 17:55:30,567.567] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'pk_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:55:30,680.680] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:55:30,681.681] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00053s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:55:30,845.845] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2024-10-11 17:55:30,845.845] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00027s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:55:30,907.907] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:55:30,907.907] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00040s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:55:31,040.040] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:55:31,041.041] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:55:31] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 17:55:52,871.871] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:55:52,872.872] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:55:52,872.872] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00015s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:55:52,876.876] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 17:55:52,876.876] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 17, 55, 52, 875807), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:55:52,876.876] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:55:52,882.882] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:55:52,883.883] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:55:52,883.883] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:55:52,924.924] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:55:52,925.925] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:55:52] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 17:56:06,318.318] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:56:06,319.319] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:56:06,319.319] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.45s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:56:06,321.321] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 17:56:06,321.321] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:56:06,324.324] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2024-10-11 17:56:06,324.324] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00017s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'node_id': '102d9e92-fd4e-413f-9f17-a76803ff2db4', 'position': 18, 'content': 'Lesstionï¼Œè½»åŠ¨ç¬”è®°ï¼Œç”¨AIä¸ºç¬”è®°èµ‹èƒ½', 'character_count': 22, 'token_count': 20, 'keywords': '["\\u7b14\\u8bb0", "AI", "Lesstion"]', 'hash': '9fa344e19467cc7b37d8bf66eecc5381d7a9a7954e3b5d165112a1730091faf5', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2024, 10, 11, 17, 56, 6, 323766), 'indexing_completed_at': datetime.datetime(2024, 10, 11, 17, 56, 6, 323766), 'completed_at': datetime.datetime(2024, 10, 11, 17, 56, 6, 323766), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2024-10-11 17:56:06,423.423] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:56:06,452.452] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:56:06,452.452] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:56:06,453.453] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.57s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:56:06,457.457] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:56:06,457.457] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'pk_1': UUID('7c8c4937-f194-43ec-bb33-cd66e89d4b7c')}
[2024-10-11 17:56:07,545.545] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2024-10-11 17:56:07,546.546] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00033s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2024-10-11 17:56:07,546.546] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 17:56:07,546.546] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'character_count': 12193, 'token_count': 6659, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:56:07,546.546] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:56:07,562.562] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:56:07,562.562] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 17:56:07,562.562] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1.106s ago] {'pk_1': UUID('7c8c4937-f194-43ec-bb33-cd66e89d4b7c')}
[2024-10-11 17:56:07,564.564] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 17:56:07,564.564] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 17:56:07,565.565] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 17:56:07,565.565] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'id_1_1': UUID('7c8c4937-f194-43ec-bb33-cd66e89d4b7c')}
[2024-10-11 17:56:07,566.566] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 17:56:07,566.566] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'keyword_table': '{"\\u7b14\\u8bb0": ["7c8c4937-f194-43ec-bb33-cd66e89d4b7c"], "AI": ["7c8c4937-f194-43ec-bb33-cd66e89d4b7c"], "Lesstion": ["7c8c4937-f194-43ec-bb33-cd66e89d4b7c"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 17:56:07,567.567] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 17:56:07,569.569] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:56:07] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 17:56:13,090.090] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 17:56:13,090.090] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 17:56:13,090.090] base.py -> _exec_single_context line:1908 [INFO]: [cached since 20.22s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:56:13,093.093] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 17:56:13,093.093] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 17:56:13,097.097] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 17:56:13,097.097] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00030s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 17:56:13,099.099] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 17:56:13,100.100] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 17:56:13] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 18:07:31,510.510] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:07:31,510.510] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:07:31,510.510] base.py -> _exec_single_context line:1908 [INFO]: [cached since 698.6s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:07:31,512.512] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 18:07:31,513.513] base.py -> _exec_single_context line:1908 [INFO]: [cached since 698.6s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:07:31,513.513] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:07:31,538.538] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:07:31,538.538] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:07:31,539.539] base.py -> _exec_single_context line:1908 [INFO]: [cached since 698.7s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:07:31,582.582] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 18:07:31,583.583] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 18:07:31] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 18:29:44,246.246] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\model\\dataset.py', reloading
[2024-10-11 18:29:44,560.560] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 18:29:48,533.533] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 18:29:48,536.536] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 18:30:18,573.573] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 18:30:18,842.842] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 18:30:22,673.673] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 18:30:22,676.676] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 18:30:45,247.247] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 18:30:45,247.247] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 18:30:45,248.248] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 18:30:45,249.249] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 18:30:45,249.249] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 18:30:45,249.249] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 18:30:45,250.250] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:30:45,251.251] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:30:45,251.251] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:30:45,254.254] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 18:30:45,254.254] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 18, 30, 45, 253444), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:30:45,255.255] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:30:45,260.260] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:30:45,261.261] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:30:45,261.261] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00017s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:30:45,300.300] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 18:30:45,301.301] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 18:30:45] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 18:31:05,090.090] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:31:05,090.090] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:31:05,090.090] base.py -> _exec_single_context line:1908 [INFO]: [cached since 19.84s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:31:05,092.092] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 18:31:05,092.092] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:31:05,094.094] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2024-10-11 18:31:05,094.094] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'node_id': '4c173724-432f-420d-894f-8e94c042ea57', 'position': 19, 'content': 'Lesstionï¼Œè½»åŠ¨ç¬”è®°ï¼Œç”¨AIä¸ºç¬”è®°èµ‹èƒ½', 'character_count': 22, 'token_count': 20, 'keywords': '["\\u7b14\\u8bb0", "AI", "Lesstion"]', 'hash': '9fa344e19467cc7b37d8bf66eecc5381d7a9a7954e3b5d165112a1730091faf5', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2024, 10, 11, 18, 31, 5, 93481), 'indexing_completed_at': datetime.datetime(2024, 10, 11, 18, 31, 5, 93481), 'completed_at': datetime.datetime(2024, 10, 11, 18, 31, 5, 93481), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2024-10-11 18:31:05,095.095] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:31:05,099.099] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:31:05,099.099] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:31:05,099.099] base.py -> _exec_single_context line:1908 [INFO]: [cached since 19.84s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:31:05,100.100] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 18:31:05,101.101] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('a6dda528-35ca-400c-90d3-53f5674f88d4')}
[2024-10-11 18:31:06,154.154] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2024-10-11 18:31:06,154.154] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00029s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2024-10-11 18:31:06,155.155] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 18:31:06,156.156] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'character_count': 12215, 'token_count': 6679, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:31:06,156.156] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:31:06,174.174] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:31:06,174.174] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 18:31:06,174.174] base.py -> _exec_single_context line:1908 [INFO]: [cached since 1.075s ago] {'pk_1': UUID('a6dda528-35ca-400c-90d3-53f5674f88d4')}
[2024-10-11 18:31:06,177.177] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 18:31:06,177.177] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 18:31:06,178.178] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 18:31:06,178.178] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'id_1_1': UUID('a6dda528-35ca-400c-90d3-53f5674f88d4')}
[2024-10-11 18:31:06,179.179] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 18:31:06,179.179] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'keyword_table': '{"\\u7b14\\u8bb0": ["a6dda528-35ca-400c-90d3-53f5674f88d4"], "AI": ["a6dda528-35ca-400c-90d3-53f5674f88d4"], "Lesstion": ["a6dda528-35ca-400c-90d3-53f5674f88d4"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 18:31:06,179.179] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:31:06,181.181] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 18:31:06] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 18:32:08,415.415] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 18:32:08,801.801] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 18:32:12,593.593] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 18:32:12,595.595] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 18:32:14,657.657] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 18:32:14,657.657] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 18:32:14,658.658] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 18:32:14,659.659] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 18:32:14,659.659] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 18:32:14,659.659] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 18:32:14,660.660] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:14,661.661] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:14,661.661] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:14,664.664] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 18:32:14,664.664] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:14,665.665] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:32:14,671.671] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:14,671.671] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:14,671.671] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00012s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:14,700.700] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 18:32:14,701.701] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 18:32:14] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 18:32:23,263.263] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:23,263.263] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:23,264.264] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.603s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:23,265.265] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 18:32:23,265.265] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.601s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 18, 32, 23, 265732), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:23,266.266] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:32:23,269.269] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:23,269.269] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:23,269.269] base.py -> _exec_single_context line:1908 [INFO]: [cached since 8.598s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:23,299.299] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 18:32:23,299.299] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 18:32:23] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 18:32:27,423.423] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:27,423.423] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:27,423.423] base.py -> _exec_single_context line:1908 [INFO]: [cached since 12.76s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:27,426.426] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2024-10-11 18:32:27,426.426] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'coalesce_2': 0, 'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:27,428.428] base.py -> _exec_single_context line:1903 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2024-10-11 18:32:27,428.428] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00018s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89'), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'node_id': 'bd8707e3-7f71-474f-a5de-a0d1df0a0798', 'position': 20, 'content': 'Lesstionï¼Œè½»åŠ¨ç¬”è®°ï¼Œç”¨AIä¸ºç¬”è®°èµ‹èƒ½', 'character_count': 22, 'token_count': 20, 'keywords': '["\\u7b14\\u8bb0", "AI", "Lesstion"]', 'hash': '9fa344e19467cc7b37d8bf66eecc5381d7a9a7954e3b5d165112a1730091faf5', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2024, 10, 11, 18, 32, 27, 426179), 'indexing_completed_at': datetime.datetime(2024, 10, 11, 18, 32, 27, 426179), 'completed_at': datetime.datetime(2024, 10, 11, 18, 32, 27, 426179), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2024-10-11 18:32:27,451.451] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:32:27,452.452] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:27,452.452] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:27,452.452] base.py -> _exec_single_context line:1908 [INFO]: [cached since 12.78s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:27,454.454] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 18:32:27,454.454] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'pk_1': UUID('c79bc242-9df4-4263-8aa7-50493487a9e8')}
[2024-10-11 18:32:28,188.188] base.py -> _exec_single_context line:1903 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
 LIMIT %(param_1)s
[2024-10-11 18:32:28,188.188] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'coalesce_2': 0, 'coalesce_4': 0, 'param_1': 1}
[2024-10-11 18:32:28,189.189] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 18:32:28,189.189] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00014s] {'character_count': 12237, 'token_count': 6699, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:28,190.190] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 18:32:28,192.192] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 18:32:28,192.192] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 18:32:28,192.192] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.7378s ago] {'pk_1': UUID('c79bc242-9df4-4263-8aa7-50493487a9e8')}
[2024-10-11 18:32:28,193.193] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 18:32:28,193.193] base.py -> _exec_single_context line:1908 [INFO]: [cached since 13.52s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 18:32:28,193.193] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 18:32:28,194.194] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 18:32:28] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments HTTP/1.1" 200 -
[2024-10-11 20:07:05,010.010] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:07:05,385.385] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:07:09,736.736] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:07:09,739.739] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:14:15,619.619] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:14:15,887.887] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:14:20,055.055] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:14:20,058.058] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:16:43,697.697] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:16:44,073.073] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:16:48,144.144] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:16:48,146.146] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:17:13,308.308] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 20:17:13,308.308] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 20:17:13,309.309] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 20:17:13,309.309] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 20:17:13,310.310] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 20:17:13,310.310] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 20:17:13,312.312] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:17:13,315.315] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:17:13,315.315] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00026s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:13,321.321] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 20:17:13,321.321] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00036s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 20:17:13,326.326] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 20:17:13,326.326] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:13,329.329] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:17:13,329.329] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:17:13] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 20:17:22,685.685] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:17:22,686.686] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:17:22,686.686] base.py -> _exec_single_context line:1908 [INFO]: [cached since 9.371s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:22,687.687] http.py -> _register_error_handler line:66 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "D:\Code\llmops\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "D:\Code\llmops\llmops-api\internal\handler\document_handler.py", line 77, in update_document_enabled
    self.document_service.update_document_enabled(dataset_id, document_id, req.enabled.data)
  File "D:\Code\llmops\llmops-api\internal\service\document_service.py", line 204, in update_document_enabled
    raise FailException(f"æ–‡æ¡£çŠ¶æ€ä¿®æ”¹é”™è¯¯ï¼Œå½“å‰å·²æ˜¯{'å¯ç”¨' if enabled else 'ç¦ç”¨'}çŠ¶æ€")
internal.exception.exception.FailException
[2024-10-11 20:17:22,690.690] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:17:22,690.690] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:17:22] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 20:17:27,938.938] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:17:27,939.939] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:17:27,939.939] base.py -> _exec_single_context line:1908 [INFO]: [cached since 14.62s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:27,943.943] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 20:17:27,943.943] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:27,944.944] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:17:27,952.952] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:17:27,953.953] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:17:27,953.953] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00025s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:28,014.014] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:17:28,015.015] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:17:28] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 20:17:34,933.933] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:17:34,934.934] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:17:34,934.934] base.py -> _exec_single_context line:1908 [INFO]: [cached since 21.62s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:34,935.935] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 20:17:34,935.935] base.py -> _exec_single_context line:1908 [INFO]: [cached since 21.61s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 20:17:34,936.936] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 20:17:34,938.938] base.py -> _exec_single_context line:1908 [INFO]: [cached since 21.61s ago] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:17:34,941.941] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:17:34,942.942] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:17:34] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 20:18:09,036.036] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:09,037.037] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 20:18:09,037.037] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:09,040.040] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 20:18:09,040.040] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00022s] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:09,041.041] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:18:09,044.044] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:09,045.045] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 20:18:09,045.045] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:09,046.046] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:18:09,046.046] base.py -> _exec_single_context line:1908 [INFO]: [cached since 55.73s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:09,048.048] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 20:18:09,048.048] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 20:18:09,050.050] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2024-10-11 20:18:09,050.050] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00023s] {'id_1_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:09,052.052] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 20:18:09,052.052] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00029s] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "7c8c4937-f194-43ec-bb33-cd66e89d4b7c", "a6dda528-35ca-400c-90d3-53f5674f88d4", "5c4d53e7-c0e5-41b6-8 ... (7360 characters truncated) ... ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "\\u6a21\\u578b": ["ce0256e1-f6fb-440d-b990-46c5aea86836"], "db": ["ce0256e1-f6fb-440d-b990-46c5aea86836"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 20:18:09,053.053] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:18:09,055.055] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:09,055.055] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 20:18:09,055.055] base.py -> _exec_single_context line:1908 [INFO]: [cached since 0.01084s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:09,060.060] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:18:09,061.061] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:18:09] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 20:18:25,966.966] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:25,966.966] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 20:18:25,966.966] base.py -> _exec_single_context line:1908 [INFO]: [cached since 16.93s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:25,968.968] base.py -> _exec_single_context line:1903 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2024-10-11 20:18:25,968.968] base.py -> _exec_single_context line:1908 [INFO]: [cached since 16.93s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 20, 18, 25, 968148), 'segment_id': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:25,968.968] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:18:25,971.971] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:25,971.971] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 20:18:25,971.971] base.py -> _exec_single_context line:1908 [INFO]: [cached since 16.93s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:25,972.972] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:18:25,972.972] base.py -> _exec_single_context line:1908 [INFO]: [cached since 72.66s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:25,973.973] base.py -> _exec_single_context line:1903 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2024-10-11 20:18:25,973.973] base.py -> _exec_single_context line:1908 [INFO]: [cached since 16.92s ago] {'dataset_id_1': UUID('f3f28f75-8e60-4eba-b6df-4d1b390bbd89')}
[2024-10-11 20:18:25,973.973] base.py -> _exec_single_context line:1903 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2024-10-11 20:18:25,973.973] base.py -> _exec_single_context line:1908 [INFO]: [cached since 16.92s ago] {'keyword_table': '{"AI": ["810c882b-b1be-4cbb-aa28-4f6efacf0e72", "7c8c4937-f194-43ec-bb33-cd66e89d4b7c", "a6dda528-35ca-400c-90d3-53f5674f88d4", "5c4d53e7-c0e5-41b6-8 ... (6896 characters truncated) ... c037-6952-4b86-9449-4df18990b095"], "\\u89e3\\u51b3\\u65b9\\u6848": ["aa7cd1d3-772b-421b-aaea-39a7dc36f519", "c1865914-7008-4309-b2eb-e0a4ff35590b"]}', 'keyword_table_id': UUID('2619c055-4d83-40f0-b0ed-6e7c75ebe0a9')}
[2024-10-11 20:18:25,974.974] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:18:25,975.975] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:25,975.975] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2024-10-11 20:18:25,976.976] base.py -> _exec_single_context line:1908 [INFO]: [cached since 16.93s ago] {'pk_1': UUID('ce0256e1-f6fb-440d-b990-46c5aea86836')}
[2024-10-11 20:18:25,980.980] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:18:25,980.980] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:18:25] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments/ce0256e1-f6fb-440d-b990-46c5aea86836/enabled HTTP/1.1" 200 -
[2024-10-11 20:18:31,453.453] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:31,453.453] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:18:31,453.453] base.py -> _exec_single_context line:1908 [INFO]: [cached since 78.14s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:31,455.455] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 20:18:31,455.455] base.py -> _exec_single_context line:1908 [INFO]: [cached since 63.51s ago] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 20, 18, 31, 454130), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:31,455.455] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:18:31,458.458] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:31,458.458] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:18:31,458.458] base.py -> _exec_single_context line:1908 [INFO]: [cached since 63.5s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:31,474.474] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:18:31,474.474] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:18:31] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 20:18:38,553.553] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:38,553.553] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:18:38,553.553] base.py -> _exec_single_context line:1908 [INFO]: [cached since 85.24s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:38,555.555] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 20:18:38,555.555] base.py -> _exec_single_context line:1908 [INFO]: [cached since 70.61s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:38,555.555] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:18:38,558.558] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:18:38,558.558] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:18:38,558.558] base.py -> _exec_single_context line:1908 [INFO]: [cached since 70.61s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:18:38,574.574] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:18:38,574.574] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:18:38] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 20:19:21,276.276] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:19:21,571.571] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:19:25,691.691] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:19:25,693.693] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:19:31,776.776] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:19:32,138.138] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:19:36,074.074] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:19:36,077.077] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:24:23,784.784] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:24:24,043.043] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:24:28,285.285] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:24:28,288.288] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:26:07,516.516] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:26:07,809.809] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:26:12,231.231] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:26:12,234.234] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:28:19,256.256] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\indexing_service.py', reloading
[2024-10-11 20:28:19,521.521] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 20:28:23,845.845] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 20:28:23,846.846] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 20:35:50,298.298] base.py -> _exec_single_context line:1903 [INFO]: select pg_catalog.version()
[2024-10-11 20:35:50,298.298] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 20:35:50,299.299] base.py -> _exec_single_context line:1903 [INFO]: select current_schema()
[2024-10-11 20:35:50,299.299] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 20:35:50,299.299] base.py -> _exec_single_context line:1903 [INFO]: show standard_conforming_strings
[2024-10-11 20:35:50,300.300] base.py -> _exec_single_context line:1908 [INFO]: [raw sql] {}
[2024-10-11 20:35:50,301.301] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:35:50,303.303] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:35:50,303.303] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:35:50,307.307] base.py -> _exec_single_context line:1903 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2024-10-11 20:35:50,307.307] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00019s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce'), 'param_1': 20, 'param_2': 0}
[2024-10-11 20:35:50,311.311] base.py -> _exec_single_context line:1903 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2024-10-11 20:35:50,311.311] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00020s] {'document_id_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:35:50,314.314] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:35:50,314.314] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:35:50] "GET /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/segments?current_page=1&page_size=20 HTTP/1.1" 200 -
[2024-10-11 20:35:55,436.436] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:35:55,436.436] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:35:55,436.436] base.py -> _exec_single_context line:1908 [INFO]: [cached since 5.134s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:35:55,439.439] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 20:35:55,440.440] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00016s] {'enabled': False, 'disabled_at': datetime.datetime(2024, 10, 11, 20, 35, 55, 439563), 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:35:55,440.440] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:35:55,446.446] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:35:55,446.446] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:35:55,447.447] base.py -> _exec_single_context line:1908 [INFO]: [generated in 0.00013s] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:35:55,476.476] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:35:55,477.477] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:35:55] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 20:36:05,853.853] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:36:05,854.854] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:36:05,854.854] base.py -> _exec_single_context line:1908 [INFO]: [cached since 15.55s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:36:05,855.855] base.py -> _exec_single_context line:1903 [INFO]: UPDATE document SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE document.id = %(document_id)s::UUID
[2024-10-11 20:36:05,856.856] base.py -> _exec_single_context line:1908 [INFO]: [cached since 10.42s ago] {'enabled': True, 'disabled_at': None, 'document_id': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:36:05,856.856] base.py -> _commit_impl line:1146 [INFO]: COMMIT
[2024-10-11 20:36:05,858.858] base.py -> _begin_impl line:1103 [INFO]: BEGIN (implicit)
[2024-10-11 20:36:05,858.858] base.py -> _exec_single_context line:1903 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2024-10-11 20:36:05,859.859] base.py -> _exec_single_context line:1908 [INFO]: [cached since 10.41s ago] {'pk_1': UUID('c4c940e9-42af-4150-9141-814b1d37efce')}
[2024-10-11 20:36:05,874.874] base.py -> _rollback_impl line:1129 [INFO]: ROLLBACK
[2024-10-11 20:36:05,874.874] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 20:36:05] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/documents/c4c940e9-42af-4150-9141-814b1d37efce/enabled HTTP/1.1" 200 -
[2024-10-11 22:58:10,312.312] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 22:58:10,591.591] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 22:58:14,838.838] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 22:58:14,841.841] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 22:58:55,379.379] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 22:58:55,699.699] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 22:59:00,433.433] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 22:59:00,435.435] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:03:40,383.383] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 23:03:40,702.702] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:03:44,589.589] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:03:44,592.592] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:06:51,529.529] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\model\\dataset.py', reloading
[2024-10-11 23:06:51,847.847] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:06:55,824.824] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:06:55,826.826] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:07:18,241.241] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\model\\dataset.py', reloading
[2024-10-11 23:07:18,532.532] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:07:22,748.748] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:07:22,751.751] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:07:40,072.072] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 23:07:40,366.366] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:07:44,318.318] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:07:44,321.321] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:24:34,048.048] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 23:24:34,359.359] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:24:38,365.365] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:24:38,366.366] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:24:59,045.045] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\service\\segment_service.py', reloading
[2024-10-11 23:24:59,407.407] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:25:03,862.862] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:25:03,863.863] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:28:13,995.995] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 23:28:14,284.284] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:28:18,916.916] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:28:18,919.919] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:28:32,424.424] _internal.py -> _log line:96 [INFO]: 127.0.0.1 - - [11/Oct/2024 23:28:32] "POST /datasets/f3f28f75-8e60-4eba-b6df-4d1b390bbd89/hit HTTP/1.1" 200 -
[2024-10-11 23:41:36,538.538] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 23:41:36,827.827] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:41:40,631.631] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:41:40,632.632] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
[2024-10-11 23:41:43,173.173] _internal.py -> _log line:96 [INFO]:  * Detected change in 'D:\\Code\\llmops\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2024-10-11 23:41:43,481.481] _internal.py -> _log line:96 [INFO]:  * Restarting with stat
[2024-10-11 23:41:47,523.523] _internal.py -> _log line:96 [WARNING]:  * Debugger is active!
[2024-10-11 23:41:47,526.526] _internal.py -> _log line:96 [INFO]:  * Debugger PIN: 102-324-223
